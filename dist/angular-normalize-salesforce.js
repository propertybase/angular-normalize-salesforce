'use strict';
angular.module('angular-normalize-salesforce', []);

'use strict';
angular.module('angular-normalize-salesforce').constant('ansSalesforceStandardFields', ['id', 'isdeleted', 'name', 'createddate', 'createdbyid', 'lastmodifieddate', 'lastmodifiedbyid', 'systemmodstamp', 'lastactivitydate', 'currencyisocode']);

'use strict';
angular.module('angular-normalize-salesforce').constant('ansSalesforceStandardObjects', ["acceptedeventrelation", "account", "accountcontactrole", "accountfeed", "accounthistory", "accountpartner", "accountshare", "activityhistory", "additionalnumber", "aggregateresult", "announcement", "apexclass", "apexcomponent", "apexpage", "apextestqueueitem", "apextestresult", "apextrigger", "appmenuitem", "assignmentrule", "asyncapexjob", "attachedcontentdocument", "attachment", "authsession", "brandtemplate", "businesshours", "businessprocess", "callcenter", "categorynode", "chatteractivity", "clientbrowser", "collaborationgroup", "collaborationgroupfeed", "collaborationgroupmember", "collaborationgroupmemberrequest", "collaborationinvitation", "combinedattachment", "community", "contact", "contactfeed", "contacthistory", "contactshare", "contentdocument", "contentdocumentfeed", "contentdocumenthistory", "contentdocumentlink", "contentversion", "contentversionhistory", "cronjobdetail", "crontrigger", "dashboard", "dashboardcomponent", "dashboardcomponentfeed", "dashboardfeed", "declinedeventrelation", "document", "documentattachmentmap", "domain", "domainsite", "emailservicesaddress", "emailservicesfunction", "emailstatus", "emailtemplate", "entitysubscription", "event", "eventfeed", "eventrelation", "feedcomment", "feeditem", "feedlike", "feedtrackedchange", "fieldpermissions", "fiscalyearsettings", "folder", "forecastshare", "group", "groupmember", "hashtagdefinition", "holiday", "idea", "ideacomment", "loginip", "mailmergetemplate", "mobiledeviceregistrar", "name", "note", "noteandattachment", "objectpermissions", "openactivity", "orgwideemailaddress", "ownedcontentdocument", "period", "permissionset", "permissionsetassignment", "permissionsetlicense", "permissionsetlicenseassign", "processdefinition", "processinstance", "processinstancehistory", "processinstancenode", "processinstancestep", "processinstanceworkitem", "processnode", "profile", "pushtopic", "queuesobject", "recentlyviewed", "recordtype", "report", "reportfeed", "scontrol", "setupentityaccess", "site", "sitefeed", "sitehistory", "staticresource", "task", "taskfeed", "taskpriority", "taskstatus", "topic", "topicassignment", "topicfeed", "undecidedeventrelation", "user", "userfeed", "userlicense", "userpreference", "userprofile", "userrecordaccess", "userrole", "usershare", "vote"]);

'use strict';
angular.module('angular-normalize-salesforce').constant('ansSalesforceSObjects', {
  account: ['masterrecordid', 'currencyisocode', 'division', 'id', 'accountnumber', 'ownerid', 'recordtypeid', 'site', 'accountsource', 'annualrevenue', 'billingstreet', 'billingcity', 'billingstate', 'billingpostalcode', 'billingcountry', 'createdbyid', 'createddate', 'jigsaw', 'isdeleted', 'description', 'numberofemployees', 'isexcludedfromrealign', 'fax', 'industry', 'jigsawcompanyid', 'lastactivitydate', 'lastmodifiedbyid', 'lastmodifieddate', 'lastreferenceddate', 'lastvieweddate', 'ownership', 'parentid', 'phone', 'photourl', 'rating', 'connectionreceivedid', 'sic', 'sicdesc', 'connectionsentid', 'shippingstreet', 'shippingcity', 'shippingstate', 'shippingpostalcode', 'shippingcountry', 'systemmodstamp', 'tickersymbol', 'type', 'website'],
  task: ['accountid', 'currencyisocode', 'id', 'isarchived', 'ownerid', 'calldurationinseconds', 'callobject', 'calldisposition', 'calltype', 'isclosed', 'description', 'isrecurrence', 'createdbyid', 'createddate', 'isdeleted', 'division', 'activitydate', 'recurrenceenddateonly', 'lastmodifiedbyid', 'lastmodifieddate', 'whoid', 'priority', 'isvisibleinselfservice', 'connectionreceivedid', 'recurrenceactivityid', 'recurrencedayofmonth', 'recurrencedayofweekmask', 'recurrenceinstance', 'recurrenceinterval', 'recurrencemonthofyear', 'recurrencetimezonesidkey', 'recurrencetype', 'whatid', 'reminderdatetime', 'isreminderset', 'recurrenceregeneratedtype', 'connectionsentid', 'recurrencestartdateonly', 'status', 'subject', 'systemmodstamp', 'type']
});

'use strict';
var NormalizeSalesforce,
  __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

angular.module('angular-normalize-salesforce').service('normalizeSalesforce', NormalizeSalesforce = (function() {
  function NormalizeSalesforce(ansSalesforceSObjects, ansSalesforceStandardObjects, ansSalesforceStandardFields) {
    this._denormalizeObject = __bind(this._denormalizeObject, this);
    this._denormalizeArray = __bind(this._denormalizeArray, this);
    this._denormalizeString = __bind(this._denormalizeString, this);
    this._normalizeObject = __bind(this._normalizeObject, this);
    this._normalizeArray = __bind(this._normalizeArray, this);
    this.denormalizeObjectName = __bind(this.denormalizeObjectName, this);
    this.denormalize = __bind(this.denormalize, this);
    this.normalize = __bind(this.normalize, this);
    this.standardFields = ansSalesforceStandardFields;
    this.standardObjects = ansSalesforceStandardObjects;
    this.sObjectFields = ansSalesforceSObjects;
  }

  NormalizeSalesforce.prototype.normalize = function(part) {
    var type_name;
    type_name = Object.prototype.toString.call(part);
    switch (false) {
      case !_(part).isString():
        return this._normalizeString(part);
      case !_(part).isArray():
        return this._normalizeArray(part);
      case !_(part).isObject():
        return this._normalizeObject(part);
      default:
        throw new Error("Type " + type_name + " not supported. Only String, Array and Object are supported.");
    }
  };

  NormalizeSalesforce.prototype.denormalize = function(part, sObject) {
    var type_name;
    type_name = Object.prototype.toString.call(part);
    switch (false) {
      case !_(part).isString():
        return this._denormalizeString(part, sObject);
      case !_(part).isArray():
        return this._denormalizeArray(part, sObject);
      case !_(part).isObject():
        return this._denormalizeObject(part, sObject);
      default:
        throw new Error("Type " + type_name + " not supported. Only String, Array and Object are supported.");
    }
  };

  NormalizeSalesforce.prototype.denormalizeObjectName = function(name) {
    return this._denormalize(name, this.standardObjects);
  };

  NormalizeSalesforce.prototype._normalizeString = function(string) {
    return string.toLowerCase().replace(/__c$/, '');
  };

  NormalizeSalesforce.prototype._normalizeArray = function(array) {
    return _.map(array, (function(_this) {
      return function(element) {
        return _this.normalize(element);
      };
    })(this));
  };

  NormalizeSalesforce.prototype._normalizeObject = function(object) {
    var normalized;
    normalized = {};
    _(object).forEach((function(_this) {
      return function(value, key) {
        if (_(value).isObject() && !_(value).isFunction()) {
          return normalized[_this.normalize(key)] = _this.normalize(value);
        } else {
          return normalized[_this.normalize(key)] = value;
        }
      };
    })(this));
    return normalized;
  };

  NormalizeSalesforce.prototype._denormalize = function(part, avoidList) {
    if (!_(avoidList).contains(part)) {
      return "" + part + "__c";
    } else {
      return part;
    }
  };

  NormalizeSalesforce.prototype._denormalizeString = function(string, sObject) {
    var standardFields;
    sObject = this.normalize(sObject);
    standardFields = this.standardFields;
    if (_(this.sObjectFields).has(sObject)) {
      standardFields = _.uniq(standardFields.concat(this.sObjectFields[sObject]));
    }
    return this._denormalize(string, standardFields);
  };

  NormalizeSalesforce.prototype._denormalizeArray = function(array, sObject) {
    return _.map(array, (function(_this) {
      return function(element) {
        return _this.denormalize(element, sObject);
      };
    })(this));
  };

  NormalizeSalesforce.prototype._denormalizeObject = function(object, sObject) {
    var denormalized;
    denormalized = {};
    _(object).forEach((function(_this) {
      return function(value, key) {
        if (_(value).isObject() && !_(value).isFunction()) {
          return denormalized[_this.denormalize(key, sObject)] = _this.denormalize(value, sObject);
        } else {
          return denormalized[_this.denormalize(key, sObject)] = value;
        }
      };
    })(this));
    return denormalized;
  };

  return NormalizeSalesforce;

})());

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFuZ3VsYXItbm9ybWFsaXplLXNhbGVzZm9yY2UuY29mZmVlIiwic2FsZXNmb3JjZS1zdGFuZGFyZC1maWVsZHMuY29mZmVlIiwic2FsZXNmb3JjZS1zdGFuZGFyZC1vYmplY3RzLmNvZmZlZSIsInNhbGVzZm9yY2Utc29iamVjdHMuY29mZmVlIiwic2FsZXNmb3JjZS1zb2JqZWN0cy5qcyIsIm5vcm1hbGl6ZS1zYWxlc2ZvcmNlLmNvZmZlZSIsIm5vcm1hbGl6ZS1zYWxlc2ZvcmNlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7O0FDQUE7QUFBQTs7QUNBQTtBQUFBOztBQ0FBO0FBQUE7RUFJRTtFQWtEQTtBQ2xERjs7QUNKQTtBQUFBO0VBQUE7O0FBQUEsd0RBR1MsbUJBQUE7RUFFUTtJQUtYO0lBQUE7SUFBQTtJQUFBO0lBQUE7SUFBQTtJQUFBO0lBQUE7SUFBQTtJQUNBO0lBQ0E7RUFQVzs7RUFBYjtJQVVFO0lBQUE7SUFFQTtNQUFBO1FDT0U7TURQRjtRQ1NFO01EVEY7UUNXRTtNRFhGO1FBS0k7SUFMSjtFQUhTOztFQVRYO0lBdUJFO0lBQUE7SUFFQTtNQUFBO1FDU0U7TURURjtRQ1dFO01EWEY7UUNhRTtNRGJGO1FBS0k7SUFMSjtFQUhXOztFQXRCYjtJQzZDQTtFRFZ1Qjs7RUFuQ3ZCO0lDaURBO0VEVGtCOztFQXhDbEI7SUNxREE7TUFDRTtRQUNFO01EWFc7SUFBQTtFQURFOztFQTNDakI7SUFnREU7SUFBQTtJQUVBO01DY0E7UURiRTtVQ2VFO1FBQ0Y7VUFDRTtRQUNGO01EbkJnQjtJQUFBO0lDc0JwQjtFRHpCa0I7O0VBL0NsQjtJQTJERTtNQ2tCQTtJQUNGO01BQ0U7SUFDRjtFRHRCYzs7RUExRGQ7SUFpRUU7SUFBQTtJQUVBO0lBQ0E7TUFDRTtJQ29CSjtJQUNBO0VEMUJvQjs7RUFoRXBCO0lDOEZBO01BQ0U7UUFDRTtNRHRCVztJQUFBO0VBREk7O0VBekVuQjtJQThFRTtJQUFBO0lBRUE7TUN5QkE7UUR4QkU7VUMwQkU7UUFDRjtVQUNFO1FBQ0Y7TUQ5QmdCO0lBQUE7SUNpQ3BCO0VEcENvQjs7RUN1Q3RCOztBQUVGIiwiZmlsZSI6ImFuZ3VsYXItbm9ybWFsaXplLXNhbGVzZm9yY2UuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCdcblxuYW5ndWxhci5tb2R1bGUoJ2FuZ3VsYXItbm9ybWFsaXplLXNhbGVzZm9yY2UnLFtdKVxuIiwiJ3VzZSBzdHJpY3QnXG5cbmFuZ3VsYXIubW9kdWxlKCdhbmd1bGFyLW5vcm1hbGl6ZS1zYWxlc2ZvcmNlJylcbi5jb25zdGFudCAnYW5zU2FsZXNmb3JjZVN0YW5kYXJkRmllbGRzJywgW1xuICAnaWQnXG4gICdpc2RlbGV0ZWQnXG4gICduYW1lJ1xuICAnY3JlYXRlZGRhdGUnXG4gICdjcmVhdGVkYnlpZCdcbiAgJ2xhc3Rtb2RpZmllZGRhdGUnXG4gICdsYXN0bW9kaWZpZWRieWlkJ1xuICAnc3lzdGVtbW9kc3RhbXAnXG4gICdsYXN0YWN0aXZpdHlkYXRlJ1xuICAnY3VycmVuY3lpc29jb2RlJ1xuXVxuIiwiJ3VzZSBzdHJpY3QnXG5cbmFuZ3VsYXIubW9kdWxlKCdhbmd1bGFyLW5vcm1hbGl6ZS1zYWxlc2ZvcmNlJylcbi5jb25zdGFudCAnYW5zU2FsZXNmb3JjZVN0YW5kYXJkT2JqZWN0cycsIFtcbiAgXCJhY2NlcHRlZGV2ZW50cmVsYXRpb25cIixcImFjY291bnRcIixcbiAgXCJhY2NvdW50Y29udGFjdHJvbGVcIixcImFjY291bnRmZWVkXCIsXCJhY2NvdW50aGlzdG9yeVwiLFwiYWNjb3VudHBhcnRuZXJcIixcbiAgXCJhY2NvdW50c2hhcmVcIixcImFjdGl2aXR5aGlzdG9yeVwiLFwiYWRkaXRpb25hbG51bWJlclwiLFwiYWdncmVnYXRlcmVzdWx0XCIsXG4gIFwiYW5ub3VuY2VtZW50XCIsXCJhcGV4Y2xhc3NcIixcImFwZXhjb21wb25lbnRcIixcImFwZXhwYWdlXCIsXG4gIFwiYXBleHRlc3RxdWV1ZWl0ZW1cIixcImFwZXh0ZXN0cmVzdWx0XCIsXCJhcGV4dHJpZ2dlclwiLFwiYXBwbWVudWl0ZW1cIixcbiAgXCJhc3NpZ25tZW50cnVsZVwiLFwiYXN5bmNhcGV4am9iXCIsXCJhdHRhY2hlZGNvbnRlbnRkb2N1bWVudFwiLFwiYXR0YWNobWVudFwiLFxuICBcImF1dGhzZXNzaW9uXCIsXCJicmFuZHRlbXBsYXRlXCIsXCJidXNpbmVzc2hvdXJzXCIsXCJidXNpbmVzc3Byb2Nlc3NcIixcbiAgXCJjYWxsY2VudGVyXCIsXCJjYXRlZ29yeW5vZGVcIixcImNoYXR0ZXJhY3Rpdml0eVwiLFwiY2xpZW50YnJvd3NlclwiLFxuICBcImNvbGxhYm9yYXRpb25ncm91cFwiLFwiY29sbGFib3JhdGlvbmdyb3VwZmVlZFwiLFxuICBcImNvbGxhYm9yYXRpb25ncm91cG1lbWJlclwiLFwiY29sbGFib3JhdGlvbmdyb3VwbWVtYmVycmVxdWVzdFwiLFxuICBcImNvbGxhYm9yYXRpb25pbnZpdGF0aW9uXCIsXCJjb21iaW5lZGF0dGFjaG1lbnRcIixcImNvbW11bml0eVwiLFwiY29udGFjdFwiLFxuICBcImNvbnRhY3RmZWVkXCIsXCJjb250YWN0aGlzdG9yeVwiLFwiY29udGFjdHNoYXJlXCIsXCJjb250ZW50ZG9jdW1lbnRcIixcbiAgXCJjb250ZW50ZG9jdW1lbnRmZWVkXCIsXCJjb250ZW50ZG9jdW1lbnRoaXN0b3J5XCIsXCJjb250ZW50ZG9jdW1lbnRsaW5rXCIsXG4gIFwiY29udGVudHZlcnNpb25cIixcImNvbnRlbnR2ZXJzaW9uaGlzdG9yeVwiLFwiY3JvbmpvYmRldGFpbFwiLFwiY3JvbnRyaWdnZXJcIixcbiAgXCJkYXNoYm9hcmRcIixcImRhc2hib2FyZGNvbXBvbmVudFwiLFwiZGFzaGJvYXJkY29tcG9uZW50ZmVlZFwiLFxuICBcImRhc2hib2FyZGZlZWRcIixcImRlY2xpbmVkZXZlbnRyZWxhdGlvblwiLFwiZG9jdW1lbnRcIixcbiAgXCJkb2N1bWVudGF0dGFjaG1lbnRtYXBcIixcImRvbWFpblwiLFwiZG9tYWluc2l0ZVwiLFwiZW1haWxzZXJ2aWNlc2FkZHJlc3NcIixcbiAgXCJlbWFpbHNlcnZpY2VzZnVuY3Rpb25cIixcImVtYWlsc3RhdHVzXCIsXCJlbWFpbHRlbXBsYXRlXCIsXG4gIFwiZW50aXR5c3Vic2NyaXB0aW9uXCIsXCJldmVudFwiLFwiZXZlbnRmZWVkXCIsXCJldmVudHJlbGF0aW9uXCIsXCJmZWVkY29tbWVudFwiLFxuICBcImZlZWRpdGVtXCIsXCJmZWVkbGlrZVwiLFwiZmVlZHRyYWNrZWRjaGFuZ2VcIixcImZpZWxkcGVybWlzc2lvbnNcIixcbiAgXCJmaXNjYWx5ZWFyc2V0dGluZ3NcIixcImZvbGRlclwiLFwiZm9yZWNhc3RzaGFyZVwiLFwiZ3JvdXBcIixcImdyb3VwbWVtYmVyXCIsXG4gIFwiaGFzaHRhZ2RlZmluaXRpb25cIixcImhvbGlkYXlcIixcImlkZWFcIixcImlkZWFjb21tZW50XCIsXCJsb2dpbmlwXCIsXG4gIFwibWFpbG1lcmdldGVtcGxhdGVcIixcIm1vYmlsZWRldmljZXJlZ2lzdHJhclwiLFwibmFtZVwiLFwibm90ZVwiLFxuICBcIm5vdGVhbmRhdHRhY2htZW50XCIsXCJvYmplY3RwZXJtaXNzaW9uc1wiLFwib3BlbmFjdGl2aXR5XCIsXG4gIFwib3Jnd2lkZWVtYWlsYWRkcmVzc1wiLFwib3duZWRjb250ZW50ZG9jdW1lbnRcIixcInBlcmlvZFwiLFwicGVybWlzc2lvbnNldFwiLFxuICBcInBlcm1pc3Npb25zZXRhc3NpZ25tZW50XCIsXCJwZXJtaXNzaW9uc2V0bGljZW5zZVwiLFxuICBcInBlcm1pc3Npb25zZXRsaWNlbnNlYXNzaWduXCIsXCJwcm9jZXNzZGVmaW5pdGlvblwiLFwicHJvY2Vzc2luc3RhbmNlXCIsXG4gIFwicHJvY2Vzc2luc3RhbmNlaGlzdG9yeVwiLFwicHJvY2Vzc2luc3RhbmNlbm9kZVwiLFwicHJvY2Vzc2luc3RhbmNlc3RlcFwiLFxuICBcInByb2Nlc3NpbnN0YW5jZXdvcmtpdGVtXCIsXCJwcm9jZXNzbm9kZVwiLFwicHJvZmlsZVwiLFwicHVzaHRvcGljXCIsXG4gIFwicXVldWVzb2JqZWN0XCIsXCJyZWNlbnRseXZpZXdlZFwiLFwicmVjb3JkdHlwZVwiLFwicmVwb3J0XCIsXCJyZXBvcnRmZWVkXCIsXG4gIFwic2NvbnRyb2xcIixcInNldHVwZW50aXR5YWNjZXNzXCIsXCJzaXRlXCIsXCJzaXRlZmVlZFwiLFwic2l0ZWhpc3RvcnlcIixcbiAgXCJzdGF0aWNyZXNvdXJjZVwiLFwidGFza1wiLFwidGFza2ZlZWRcIixcInRhc2twcmlvcml0eVwiLFwidGFza3N0YXR1c1wiLFwidG9waWNcIixcbiAgXCJ0b3BpY2Fzc2lnbm1lbnRcIixcInRvcGljZmVlZFwiLFwidW5kZWNpZGVkZXZlbnRyZWxhdGlvblwiLFwidXNlclwiLFxuICBcInVzZXJmZWVkXCIsXCJ1c2VybGljZW5zZVwiLFwidXNlcnByZWZlcmVuY2VcIixcInVzZXJwcm9maWxlXCIsXG4gIFwidXNlcnJlY29yZGFjY2Vzc1wiLFwidXNlcnJvbGVcIixcInVzZXJzaGFyZVwiLFwidm90ZVwiXG5dXG4iLCIndXNlIHN0cmljdCdcblxuYW5ndWxhci5tb2R1bGUoJ2FuZ3VsYXItbm9ybWFsaXplLXNhbGVzZm9yY2UnKVxuLmNvbnN0YW50ICdhbnNTYWxlc2ZvcmNlU09iamVjdHMnLCB7XG4gIGFjY291bnQ6IFtcbiAgICAnbWFzdGVycmVjb3JkaWQnLFxuICAgICdjdXJyZW5jeWlzb2NvZGUnLFxuICAgICdkaXZpc2lvbicsXG4gICAgJ2lkJyxcbiAgICAnYWNjb3VudG51bWJlcicsXG4gICAgJ293bmVyaWQnLFxuICAgICdyZWNvcmR0eXBlaWQnLFxuICAgICdzaXRlJyxcbiAgICAnYWNjb3VudHNvdXJjZScsXG4gICAgJ2FubnVhbHJldmVudWUnLFxuICAgICdiaWxsaW5nc3RyZWV0JyxcbiAgICAnYmlsbGluZ2NpdHknLFxuICAgICdiaWxsaW5nc3RhdGUnLFxuICAgICdiaWxsaW5ncG9zdGFsY29kZScsXG4gICAgJ2JpbGxpbmdjb3VudHJ5JyxcbiAgICAnY3JlYXRlZGJ5aWQnLFxuICAgICdjcmVhdGVkZGF0ZScsXG4gICAgJ2ppZ3NhdycsXG4gICAgJ2lzZGVsZXRlZCcsXG4gICAgJ2Rlc2NyaXB0aW9uJyxcbiAgICAnbnVtYmVyb2ZlbXBsb3llZXMnLFxuICAgICdpc2V4Y2x1ZGVkZnJvbXJlYWxpZ24nLFxuICAgICdmYXgnLFxuICAgICdpbmR1c3RyeScsXG4gICAgJ2ppZ3Nhd2NvbXBhbnlpZCcsXG4gICAgJ2xhc3RhY3Rpdml0eWRhdGUnLFxuICAgICdsYXN0bW9kaWZpZWRieWlkJyxcbiAgICAnbGFzdG1vZGlmaWVkZGF0ZScsXG4gICAgJ2xhc3RyZWZlcmVuY2VkZGF0ZScsXG4gICAgJ2xhc3R2aWV3ZWRkYXRlJyxcbiAgICAnb3duZXJzaGlwJyxcbiAgICAncGFyZW50aWQnLFxuICAgICdwaG9uZScsXG4gICAgJ3Bob3RvdXJsJyxcbiAgICAncmF0aW5nJyxcbiAgICAnY29ubmVjdGlvbnJlY2VpdmVkaWQnLFxuICAgICdzaWMnLFxuICAgICdzaWNkZXNjJyxcbiAgICAnY29ubmVjdGlvbnNlbnRpZCcsXG4gICAgJ3NoaXBwaW5nc3RyZWV0JyxcbiAgICAnc2hpcHBpbmdjaXR5JyxcbiAgICAnc2hpcHBpbmdzdGF0ZScsXG4gICAgJ3NoaXBwaW5ncG9zdGFsY29kZScsXG4gICAgJ3NoaXBwaW5nY291bnRyeScsXG4gICAgJ3N5c3RlbW1vZHN0YW1wJyxcbiAgICAndGlja2Vyc3ltYm9sJyxcbiAgICAndHlwZScsXG4gICAgJ3dlYnNpdGUnXG4gIF1cbiAgdGFzazogW1xuICAgICdhY2NvdW50aWQnLFxuICAgICdjdXJyZW5jeWlzb2NvZGUnLFxuICAgICdpZCcsXG4gICAgJ2lzYXJjaGl2ZWQnLFxuICAgICdvd25lcmlkJyxcbiAgICAnY2FsbGR1cmF0aW9uaW5zZWNvbmRzJyxcbiAgICAnY2FsbG9iamVjdCcsXG4gICAgJ2NhbGxkaXNwb3NpdGlvbicsXG4gICAgJ2NhbGx0eXBlJyxcbiAgICAnaXNjbG9zZWQnLFxuICAgICdkZXNjcmlwdGlvbicsXG4gICAgJ2lzcmVjdXJyZW5jZScsXG4gICAgJ2NyZWF0ZWRieWlkJyxcbiAgICAnY3JlYXRlZGRhdGUnLFxuICAgICdpc2RlbGV0ZWQnLFxuICAgICdkaXZpc2lvbicsXG4gICAgJ2FjdGl2aXR5ZGF0ZScsXG4gICAgJ3JlY3VycmVuY2VlbmRkYXRlb25seScsXG4gICAgJ2xhc3Rtb2RpZmllZGJ5aWQnLFxuICAgICdsYXN0bW9kaWZpZWRkYXRlJyxcbiAgICAnd2hvaWQnLFxuICAgICdwcmlvcml0eScsXG4gICAgJ2lzdmlzaWJsZWluc2VsZnNlcnZpY2UnLFxuICAgICdjb25uZWN0aW9ucmVjZWl2ZWRpZCcsXG4gICAgJ3JlY3VycmVuY2VhY3Rpdml0eWlkJyxcbiAgICAncmVjdXJyZW5jZWRheW9mbW9udGgnLFxuICAgICdyZWN1cnJlbmNlZGF5b2Z3ZWVrbWFzaycsXG4gICAgJ3JlY3VycmVuY2VpbnN0YW5jZScsXG4gICAgJ3JlY3VycmVuY2VpbnRlcnZhbCcsXG4gICAgJ3JlY3VycmVuY2Vtb250aG9meWVhcicsXG4gICAgJ3JlY3VycmVuY2V0aW1lem9uZXNpZGtleScsXG4gICAgJ3JlY3VycmVuY2V0eXBlJyxcbiAgICAnd2hhdGlkJyxcbiAgICAncmVtaW5kZXJkYXRldGltZScsXG4gICAgJ2lzcmVtaW5kZXJzZXQnLFxuICAgICdyZWN1cnJlbmNlcmVnZW5lcmF0ZWR0eXBlJyxcbiAgICAnY29ubmVjdGlvbnNlbnRpZCcsXG4gICAgJ3JlY3VycmVuY2VzdGFydGRhdGVvbmx5JyxcbiAgICAnc3RhdHVzJyxcbiAgICAnc3ViamVjdCcsXG4gICAgJ3N5c3RlbW1vZHN0YW1wJyxcbiAgICAndHlwZSdcbiAgXVxufVxuIiwiJ3VzZSBzdHJpY3QnO1xuYW5ndWxhci5tb2R1bGUoJ2FuZ3VsYXItbm9ybWFsaXplLXNhbGVzZm9yY2UnKS5jb25zdGFudCgnYW5zU2FsZXNmb3JjZVNPYmplY3RzJywge1xuICBhY2NvdW50OiBbJ21hc3RlcnJlY29yZGlkJywgJ2N1cnJlbmN5aXNvY29kZScsICdkaXZpc2lvbicsICdpZCcsICdhY2NvdW50bnVtYmVyJywgJ293bmVyaWQnLCAncmVjb3JkdHlwZWlkJywgJ3NpdGUnLCAnYWNjb3VudHNvdXJjZScsICdhbm51YWxyZXZlbnVlJywgJ2JpbGxpbmdzdHJlZXQnLCAnYmlsbGluZ2NpdHknLCAnYmlsbGluZ3N0YXRlJywgJ2JpbGxpbmdwb3N0YWxjb2RlJywgJ2JpbGxpbmdjb3VudHJ5JywgJ2NyZWF0ZWRieWlkJywgJ2NyZWF0ZWRkYXRlJywgJ2ppZ3NhdycsICdpc2RlbGV0ZWQnLCAnZGVzY3JpcHRpb24nLCAnbnVtYmVyb2ZlbXBsb3llZXMnLCAnaXNleGNsdWRlZGZyb21yZWFsaWduJywgJ2ZheCcsICdpbmR1c3RyeScsICdqaWdzYXdjb21wYW55aWQnLCAnbGFzdGFjdGl2aXR5ZGF0ZScsICdsYXN0bW9kaWZpZWRieWlkJywgJ2xhc3Rtb2RpZmllZGRhdGUnLCAnbGFzdHJlZmVyZW5jZWRkYXRlJywgJ2xhc3R2aWV3ZWRkYXRlJywgJ293bmVyc2hpcCcsICdwYXJlbnRpZCcsICdwaG9uZScsICdwaG90b3VybCcsICdyYXRpbmcnLCAnY29ubmVjdGlvbnJlY2VpdmVkaWQnLCAnc2ljJywgJ3NpY2Rlc2MnLCAnY29ubmVjdGlvbnNlbnRpZCcsICdzaGlwcGluZ3N0cmVldCcsICdzaGlwcGluZ2NpdHknLCAnc2hpcHBpbmdzdGF0ZScsICdzaGlwcGluZ3Bvc3RhbGNvZGUnLCAnc2hpcHBpbmdjb3VudHJ5JywgJ3N5c3RlbW1vZHN0YW1wJywgJ3RpY2tlcnN5bWJvbCcsICd0eXBlJywgJ3dlYnNpdGUnXSxcbiAgdGFzazogWydhY2NvdW50aWQnLCAnY3VycmVuY3lpc29jb2RlJywgJ2lkJywgJ2lzYXJjaGl2ZWQnLCAnb3duZXJpZCcsICdjYWxsZHVyYXRpb25pbnNlY29uZHMnLCAnY2FsbG9iamVjdCcsICdjYWxsZGlzcG9zaXRpb24nLCAnY2FsbHR5cGUnLCAnaXNjbG9zZWQnLCAnZGVzY3JpcHRpb24nLCAnaXNyZWN1cnJlbmNlJywgJ2NyZWF0ZWRieWlkJywgJ2NyZWF0ZWRkYXRlJywgJ2lzZGVsZXRlZCcsICdkaXZpc2lvbicsICdhY3Rpdml0eWRhdGUnLCAncmVjdXJyZW5jZWVuZGRhdGVvbmx5JywgJ2xhc3Rtb2RpZmllZGJ5aWQnLCAnbGFzdG1vZGlmaWVkZGF0ZScsICd3aG9pZCcsICdwcmlvcml0eScsICdpc3Zpc2libGVpbnNlbGZzZXJ2aWNlJywgJ2Nvbm5lY3Rpb25yZWNlaXZlZGlkJywgJ3JlY3VycmVuY2VhY3Rpdml0eWlkJywgJ3JlY3VycmVuY2VkYXlvZm1vbnRoJywgJ3JlY3VycmVuY2VkYXlvZndlZWttYXNrJywgJ3JlY3VycmVuY2VpbnN0YW5jZScsICdyZWN1cnJlbmNlaW50ZXJ2YWwnLCAncmVjdXJyZW5jZW1vbnRob2Z5ZWFyJywgJ3JlY3VycmVuY2V0aW1lem9uZXNpZGtleScsICdyZWN1cnJlbmNldHlwZScsICd3aGF0aWQnLCAncmVtaW5kZXJkYXRldGltZScsICdpc3JlbWluZGVyc2V0JywgJ3JlY3VycmVuY2VyZWdlbmVyYXRlZHR5cGUnLCAnY29ubmVjdGlvbnNlbnRpZCcsICdyZWN1cnJlbmNlc3RhcnRkYXRlb25seScsICdzdGF0dXMnLCAnc3ViamVjdCcsICdzeXN0ZW1tb2RzdGFtcCcsICd0eXBlJ11cbn0pO1xuIiwiJ3VzZSBzdHJpY3QnXG5cbmFuZ3VsYXIubW9kdWxlKCdhbmd1bGFyLW5vcm1hbGl6ZS1zYWxlc2ZvcmNlJylcbi5zZXJ2aWNlICdub3JtYWxpemVTYWxlc2ZvcmNlJyxcbiAgY2xhc3MgTm9ybWFsaXplU2FsZXNmb3JjZVxuICAgIGNvbnN0cnVjdG9yOiAoXG4gICAgICBhbnNTYWxlc2ZvcmNlU09iamVjdHMsXG4gICAgICBhbnNTYWxlc2ZvcmNlU3RhbmRhcmRPYmplY3RzLFxuICAgICAgYW5zU2FsZXNmb3JjZVN0YW5kYXJkRmllbGRzXG4gICAgKSAtPlxuICAgICAgQHN0YW5kYXJkRmllbGRzID0gYW5zU2FsZXNmb3JjZVN0YW5kYXJkRmllbGRzXG4gICAgICBAc3RhbmRhcmRPYmplY3RzID0gYW5zU2FsZXNmb3JjZVN0YW5kYXJkT2JqZWN0c1xuICAgICAgQHNPYmplY3RGaWVsZHMgPSBhbnNTYWxlc2ZvcmNlU09iamVjdHNcblxuICAgIG5vcm1hbGl6ZTogKHBhcnQpID0+XG4gICAgICB0eXBlX25hbWUgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwocGFydClcblxuICAgICAgc3dpdGNoXG4gICAgICAgIHdoZW4gXyhwYXJ0KS5pc1N0cmluZygpIHRoZW4gQF9ub3JtYWxpemVTdHJpbmcocGFydClcbiAgICAgICAgd2hlbiBfKHBhcnQpLmlzQXJyYXkoKSAgdGhlbiBAX25vcm1hbGl6ZUFycmF5KHBhcnQpXG4gICAgICAgIHdoZW4gXyhwYXJ0KS5pc09iamVjdCgpIHRoZW4gQF9ub3JtYWxpemVPYmplY3QocGFydClcbiAgICAgICAgZWxzZVxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICAgIFwiVHlwZSAje3R5cGVfbmFtZX0gbm90IHN1cHBvcnRlZC5cbiAgICAgICAgICAgIE9ubHkgU3RyaW5nLCBBcnJheSBhbmQgT2JqZWN0IGFyZSBzdXBwb3J0ZWQuXCJcbiAgICAgICAgICApXG5cbiAgICBkZW5vcm1hbGl6ZTogKHBhcnQsIHNPYmplY3QpID0+XG4gICAgICB0eXBlX25hbWUgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwocGFydClcblxuICAgICAgc3dpdGNoXG4gICAgICAgIHdoZW4gXyhwYXJ0KS5pc1N0cmluZygpIHRoZW4gQF9kZW5vcm1hbGl6ZVN0cmluZyhwYXJ0LCBzT2JqZWN0KVxuICAgICAgICB3aGVuIF8ocGFydCkuaXNBcnJheSgpICB0aGVuIEBfZGVub3JtYWxpemVBcnJheShwYXJ0LCBzT2JqZWN0KVxuICAgICAgICB3aGVuIF8ocGFydCkuaXNPYmplY3QoKSB0aGVuIEBfZGVub3JtYWxpemVPYmplY3QocGFydCwgc09iamVjdClcbiAgICAgICAgZWxzZVxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICAgIFwiVHlwZSAje3R5cGVfbmFtZX0gbm90IHN1cHBvcnRlZC5cbiAgICAgICAgICAgIE9ubHkgU3RyaW5nLCBBcnJheSBhbmQgT2JqZWN0IGFyZSBzdXBwb3J0ZWQuXCJcbiAgICAgICAgICApXG5cbiAgICBkZW5vcm1hbGl6ZU9iamVjdE5hbWU6IChuYW1lKSA9PlxuICAgICAgQF9kZW5vcm1hbGl6ZSBuYW1lLCBAc3RhbmRhcmRPYmplY3RzXG5cbiAgICAjIFBSSVZBVEUgLS0tLS0tLS0tLVxuXG4gICAgX25vcm1hbGl6ZVN0cmluZzogKHN0cmluZykgLT5cbiAgICAgIHN0cmluZy50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL19fYyQvLCAnJylcblxuICAgIF9ub3JtYWxpemVBcnJheTogKGFycmF5KSA9PlxuICAgICAgXy5tYXAgYXJyYXksIChlbGVtZW50KSA9PlxuICAgICAgICBAbm9ybWFsaXplKGVsZW1lbnQpXG5cbiAgICBfbm9ybWFsaXplT2JqZWN0OiAob2JqZWN0KSA9PlxuICAgICAgbm9ybWFsaXplZCA9IHt9XG5cbiAgICAgIF8ob2JqZWN0KS5mb3JFYWNoICh2YWx1ZSwga2V5KSA9PlxuICAgICAgICBpZiBfKHZhbHVlKS5pc09iamVjdCgpICYmICFfKHZhbHVlKS5pc0Z1bmN0aW9uKClcbiAgICAgICAgICBub3JtYWxpemVkW0Bub3JtYWxpemUoa2V5KV0gPSBAbm9ybWFsaXplKHZhbHVlKVxuICAgICAgICBlbHNlXG4gICAgICAgICAgbm9ybWFsaXplZFtAbm9ybWFsaXplKGtleSldID0gdmFsdWVcblxuICAgICAgbm9ybWFsaXplZFxuXG4gICAgX2Rlbm9ybWFsaXplOiAocGFydCwgYXZvaWRMaXN0KSAtPlxuICAgICAgdW5sZXNzIF8oYXZvaWRMaXN0KS5jb250YWlucyhwYXJ0KVxuICAgICAgICBcIiN7cGFydH1fX2NcIlxuICAgICAgZWxzZVxuICAgICAgICBwYXJ0XG5cbiAgICBfZGVub3JtYWxpemVTdHJpbmc6IChzdHJpbmcsIHNPYmplY3QpID0+XG4gICAgICBzT2JqZWN0ID0gQG5vcm1hbGl6ZShzT2JqZWN0KVxuXG4gICAgICBzdGFuZGFyZEZpZWxkcyA9IEBzdGFuZGFyZEZpZWxkc1xuICAgICAgaWYgXyhAc09iamVjdEZpZWxkcykuaGFzKHNPYmplY3QpXG4gICAgICAgIHN0YW5kYXJkRmllbGRzID0gXy51bmlxKHN0YW5kYXJkRmllbGRzLmNvbmNhdChAc09iamVjdEZpZWxkc1tzT2JqZWN0XSkpXG5cbiAgICAgIEBfZGVub3JtYWxpemUgc3RyaW5nLCBzdGFuZGFyZEZpZWxkc1xuXG4gICAgX2Rlbm9ybWFsaXplQXJyYXk6IChhcnJheSwgc09iamVjdCkgPT5cbiAgICAgIF8ubWFwIGFycmF5LCAoZWxlbWVudCkgPT5cbiAgICAgICAgQGRlbm9ybWFsaXplKGVsZW1lbnQsIHNPYmplY3QpXG5cbiAgICBfZGVub3JtYWxpemVPYmplY3Q6IChvYmplY3QsIHNPYmplY3QpID0+XG4gICAgICBkZW5vcm1hbGl6ZWQgPSB7fVxuXG4gICAgICBfKG9iamVjdCkuZm9yRWFjaCAodmFsdWUsIGtleSkgPT5cbiAgICAgICAgaWYgXyh2YWx1ZSkuaXNPYmplY3QoKSAmJiAhXyh2YWx1ZSkuaXNGdW5jdGlvbigpXG4gICAgICAgICAgZGVub3JtYWxpemVkW0BkZW5vcm1hbGl6ZShrZXksIHNPYmplY3QpXSA9IEBkZW5vcm1hbGl6ZShcbiAgICAgICAgICAgIHZhbHVlLCBzT2JqZWN0XG4gICAgICAgICAgKVxuICAgICAgICBlbHNlXG4gICAgICAgICAgZGVub3JtYWxpemVkW0BkZW5vcm1hbGl6ZShrZXksIHNPYmplY3QpXSA9IHZhbHVlXG5cbiAgICAgIGRlbm9ybWFsaXplZFxuIiwiJ3VzZSBzdHJpY3QnO1xudmFyIE5vcm1hbGl6ZVNhbGVzZm9yY2UsXG4gIF9fYmluZCA9IGZ1bmN0aW9uKGZuLCBtZSl7IHJldHVybiBmdW5jdGlvbigpeyByZXR1cm4gZm4uYXBwbHkobWUsIGFyZ3VtZW50cyk7IH07IH07XG5cbmFuZ3VsYXIubW9kdWxlKCdhbmd1bGFyLW5vcm1hbGl6ZS1zYWxlc2ZvcmNlJykuc2VydmljZSgnbm9ybWFsaXplU2FsZXNmb3JjZScsIE5vcm1hbGl6ZVNhbGVzZm9yY2UgPSAoZnVuY3Rpb24oKSB7XG4gIGZ1bmN0aW9uIE5vcm1hbGl6ZVNhbGVzZm9yY2UoYW5zU2FsZXNmb3JjZVNPYmplY3RzLCBhbnNTYWxlc2ZvcmNlU3RhbmRhcmRPYmplY3RzLCBhbnNTYWxlc2ZvcmNlU3RhbmRhcmRGaWVsZHMpIHtcbiAgICB0aGlzLl9kZW5vcm1hbGl6ZU9iamVjdCA9IF9fYmluZCh0aGlzLl9kZW5vcm1hbGl6ZU9iamVjdCwgdGhpcyk7XG4gICAgdGhpcy5fZGVub3JtYWxpemVBcnJheSA9IF9fYmluZCh0aGlzLl9kZW5vcm1hbGl6ZUFycmF5LCB0aGlzKTtcbiAgICB0aGlzLl9kZW5vcm1hbGl6ZVN0cmluZyA9IF9fYmluZCh0aGlzLl9kZW5vcm1hbGl6ZVN0cmluZywgdGhpcyk7XG4gICAgdGhpcy5fbm9ybWFsaXplT2JqZWN0ID0gX19iaW5kKHRoaXMuX25vcm1hbGl6ZU9iamVjdCwgdGhpcyk7XG4gICAgdGhpcy5fbm9ybWFsaXplQXJyYXkgPSBfX2JpbmQodGhpcy5fbm9ybWFsaXplQXJyYXksIHRoaXMpO1xuICAgIHRoaXMuZGVub3JtYWxpemVPYmplY3ROYW1lID0gX19iaW5kKHRoaXMuZGVub3JtYWxpemVPYmplY3ROYW1lLCB0aGlzKTtcbiAgICB0aGlzLmRlbm9ybWFsaXplID0gX19iaW5kKHRoaXMuZGVub3JtYWxpemUsIHRoaXMpO1xuICAgIHRoaXMubm9ybWFsaXplID0gX19iaW5kKHRoaXMubm9ybWFsaXplLCB0aGlzKTtcbiAgICB0aGlzLnN0YW5kYXJkRmllbGRzID0gYW5zU2FsZXNmb3JjZVN0YW5kYXJkRmllbGRzO1xuICAgIHRoaXMuc3RhbmRhcmRPYmplY3RzID0gYW5zU2FsZXNmb3JjZVN0YW5kYXJkT2JqZWN0cztcbiAgICB0aGlzLnNPYmplY3RGaWVsZHMgPSBhbnNTYWxlc2ZvcmNlU09iamVjdHM7XG4gIH1cblxuICBOb3JtYWxpemVTYWxlc2ZvcmNlLnByb3RvdHlwZS5ub3JtYWxpemUgPSBmdW5jdGlvbihwYXJ0KSB7XG4gICAgdmFyIHR5cGVfbmFtZTtcbiAgICB0eXBlX25hbWUgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwocGFydCk7XG4gICAgc3dpdGNoIChmYWxzZSkge1xuICAgICAgY2FzZSAhXyhwYXJ0KS5pc1N0cmluZygpOlxuICAgICAgICByZXR1cm4gdGhpcy5fbm9ybWFsaXplU3RyaW5nKHBhcnQpO1xuICAgICAgY2FzZSAhXyhwYXJ0KS5pc0FycmF5KCk6XG4gICAgICAgIHJldHVybiB0aGlzLl9ub3JtYWxpemVBcnJheShwYXJ0KTtcbiAgICAgIGNhc2UgIV8ocGFydCkuaXNPYmplY3QoKTpcbiAgICAgICAgcmV0dXJuIHRoaXMuX25vcm1hbGl6ZU9iamVjdChwYXJ0KTtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlR5cGUgXCIgKyB0eXBlX25hbWUgKyBcIiBub3Qgc3VwcG9ydGVkLiBPbmx5IFN0cmluZywgQXJyYXkgYW5kIE9iamVjdCBhcmUgc3VwcG9ydGVkLlwiKTtcbiAgICB9XG4gIH07XG5cbiAgTm9ybWFsaXplU2FsZXNmb3JjZS5wcm90b3R5cGUuZGVub3JtYWxpemUgPSBmdW5jdGlvbihwYXJ0LCBzT2JqZWN0KSB7XG4gICAgdmFyIHR5cGVfbmFtZTtcbiAgICB0eXBlX25hbWUgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwocGFydCk7XG4gICAgc3dpdGNoIChmYWxzZSkge1xuICAgICAgY2FzZSAhXyhwYXJ0KS5pc1N0cmluZygpOlxuICAgICAgICByZXR1cm4gdGhpcy5fZGVub3JtYWxpemVTdHJpbmcocGFydCwgc09iamVjdCk7XG4gICAgICBjYXNlICFfKHBhcnQpLmlzQXJyYXkoKTpcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Rlbm9ybWFsaXplQXJyYXkocGFydCwgc09iamVjdCk7XG4gICAgICBjYXNlICFfKHBhcnQpLmlzT2JqZWN0KCk6XG4gICAgICAgIHJldHVybiB0aGlzLl9kZW5vcm1hbGl6ZU9iamVjdChwYXJ0LCBzT2JqZWN0KTtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlR5cGUgXCIgKyB0eXBlX25hbWUgKyBcIiBub3Qgc3VwcG9ydGVkLiBPbmx5IFN0cmluZywgQXJyYXkgYW5kIE9iamVjdCBhcmUgc3VwcG9ydGVkLlwiKTtcbiAgICB9XG4gIH07XG5cbiAgTm9ybWFsaXplU2FsZXNmb3JjZS5wcm90b3R5cGUuZGVub3JtYWxpemVPYmplY3ROYW1lID0gZnVuY3Rpb24obmFtZSkge1xuICAgIHJldHVybiB0aGlzLl9kZW5vcm1hbGl6ZShuYW1lLCB0aGlzLnN0YW5kYXJkT2JqZWN0cyk7XG4gIH07XG5cbiAgTm9ybWFsaXplU2FsZXNmb3JjZS5wcm90b3R5cGUuX25vcm1hbGl6ZVN0cmluZyA9IGZ1bmN0aW9uKHN0cmluZykge1xuICAgIHJldHVybiBzdHJpbmcudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9fX2MkLywgJycpO1xuICB9O1xuXG4gIE5vcm1hbGl6ZVNhbGVzZm9yY2UucHJvdG90eXBlLl9ub3JtYWxpemVBcnJheSA9IGZ1bmN0aW9uKGFycmF5KSB7XG4gICAgcmV0dXJuIF8ubWFwKGFycmF5LCAoZnVuY3Rpb24oX3RoaXMpIHtcbiAgICAgIHJldHVybiBmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgICAgIHJldHVybiBfdGhpcy5ub3JtYWxpemUoZWxlbWVudCk7XG4gICAgICB9O1xuICAgIH0pKHRoaXMpKTtcbiAgfTtcblxuICBOb3JtYWxpemVTYWxlc2ZvcmNlLnByb3RvdHlwZS5fbm9ybWFsaXplT2JqZWN0ID0gZnVuY3Rpb24ob2JqZWN0KSB7XG4gICAgdmFyIG5vcm1hbGl6ZWQ7XG4gICAgbm9ybWFsaXplZCA9IHt9O1xuICAgIF8ob2JqZWN0KS5mb3JFYWNoKChmdW5jdGlvbihfdGhpcykge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uKHZhbHVlLCBrZXkpIHtcbiAgICAgICAgaWYgKF8odmFsdWUpLmlzT2JqZWN0KCkgJiYgIV8odmFsdWUpLmlzRnVuY3Rpb24oKSkge1xuICAgICAgICAgIHJldHVybiBub3JtYWxpemVkW190aGlzLm5vcm1hbGl6ZShrZXkpXSA9IF90aGlzLm5vcm1hbGl6ZSh2YWx1ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIG5vcm1hbGl6ZWRbX3RoaXMubm9ybWFsaXplKGtleSldID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfSkodGhpcykpO1xuICAgIHJldHVybiBub3JtYWxpemVkO1xuICB9O1xuXG4gIE5vcm1hbGl6ZVNhbGVzZm9yY2UucHJvdG90eXBlLl9kZW5vcm1hbGl6ZSA9IGZ1bmN0aW9uKHBhcnQsIGF2b2lkTGlzdCkge1xuICAgIGlmICghXyhhdm9pZExpc3QpLmNvbnRhaW5zKHBhcnQpKSB7XG4gICAgICByZXR1cm4gXCJcIiArIHBhcnQgKyBcIl9fY1wiO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gcGFydDtcbiAgICB9XG4gIH07XG5cbiAgTm9ybWFsaXplU2FsZXNmb3JjZS5wcm90b3R5cGUuX2Rlbm9ybWFsaXplU3RyaW5nID0gZnVuY3Rpb24oc3RyaW5nLCBzT2JqZWN0KSB7XG4gICAgdmFyIHN0YW5kYXJkRmllbGRzO1xuICAgIHNPYmplY3QgPSB0aGlzLm5vcm1hbGl6ZShzT2JqZWN0KTtcbiAgICBzdGFuZGFyZEZpZWxkcyA9IHRoaXMuc3RhbmRhcmRGaWVsZHM7XG4gICAgaWYgKF8odGhpcy5zT2JqZWN0RmllbGRzKS5oYXMoc09iamVjdCkpIHtcbiAgICAgIHN0YW5kYXJkRmllbGRzID0gXy51bmlxKHN0YW5kYXJkRmllbGRzLmNvbmNhdCh0aGlzLnNPYmplY3RGaWVsZHNbc09iamVjdF0pKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuX2Rlbm9ybWFsaXplKHN0cmluZywgc3RhbmRhcmRGaWVsZHMpO1xuICB9O1xuXG4gIE5vcm1hbGl6ZVNhbGVzZm9yY2UucHJvdG90eXBlLl9kZW5vcm1hbGl6ZUFycmF5ID0gZnVuY3Rpb24oYXJyYXksIHNPYmplY3QpIHtcbiAgICByZXR1cm4gXy5tYXAoYXJyYXksIChmdW5jdGlvbihfdGhpcykge1xuICAgICAgcmV0dXJuIGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICAgICAgcmV0dXJuIF90aGlzLmRlbm9ybWFsaXplKGVsZW1lbnQsIHNPYmplY3QpO1xuICAgICAgfTtcbiAgICB9KSh0aGlzKSk7XG4gIH07XG5cbiAgTm9ybWFsaXplU2FsZXNmb3JjZS5wcm90b3R5cGUuX2Rlbm9ybWFsaXplT2JqZWN0ID0gZnVuY3Rpb24ob2JqZWN0LCBzT2JqZWN0KSB7XG4gICAgdmFyIGRlbm9ybWFsaXplZDtcbiAgICBkZW5vcm1hbGl6ZWQgPSB7fTtcbiAgICBfKG9iamVjdCkuZm9yRWFjaCgoZnVuY3Rpb24oX3RoaXMpIHtcbiAgICAgIHJldHVybiBmdW5jdGlvbih2YWx1ZSwga2V5KSB7XG4gICAgICAgIGlmIChfKHZhbHVlKS5pc09iamVjdCgpICYmICFfKHZhbHVlKS5pc0Z1bmN0aW9uKCkpIHtcbiAgICAgICAgICByZXR1cm4gZGVub3JtYWxpemVkW190aGlzLmRlbm9ybWFsaXplKGtleSwgc09iamVjdCldID0gX3RoaXMuZGVub3JtYWxpemUodmFsdWUsIHNPYmplY3QpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiBkZW5vcm1hbGl6ZWRbX3RoaXMuZGVub3JtYWxpemUoa2V5LCBzT2JqZWN0KV0gPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9KSh0aGlzKSk7XG4gICAgcmV0dXJuIGRlbm9ybWFsaXplZDtcbiAgfTtcblxuICByZXR1cm4gTm9ybWFsaXplU2FsZXNmb3JjZTtcblxufSkoKSk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=