'use strict';
angular.module('angular-normalize-salesforce', []);

'use strict';
angular.module('angular-normalize-salesforce').constant('ansSalesforceStandardFields', ['id', 'isdeleted', 'name', 'createddate', 'createdbyid', 'lastmodifieddate', 'lastmodifiedbyid', 'systemmodstamp', 'lastactivitydate', 'currencyisocode']);

'use strict';
angular.module('angular-normalize-salesforce').constant('ansSalesforceStandardObjects', ["acceptedeventrelation", "account", "accountcontactrole", "accountfeed", "accounthistory", "accountpartner", "accountshare", "activityhistory", "additionalnumber", "aggregateresult", "announcement", "apexclass", "apexcomponent", "apexpage", "apextestqueueitem", "apextestresult", "apextrigger", "appmenuitem", "assignmentrule", "asyncapexjob", "attachedcontentdocument", "attachment", "authsession", "brandtemplate", "businesshours", "businessprocess", "callcenter", "categorynode", "chatteractivity", "clientbrowser", "collaborationgroup", "collaborationgroupfeed", "collaborationgroupmember", "collaborationgroupmemberrequest", "collaborationinvitation", "combinedattachment", "community", "contact", "contactfeed", "contacthistory", "contactshare", "contentdocument", "contentdocumentfeed", "contentdocumenthistory", "contentdocumentlink", "contentversion", "contentversionhistory", "cronjobdetail", "crontrigger", "dashboard", "dashboardcomponent", "dashboardcomponentfeed", "dashboardfeed", "declinedeventrelation", "document", "documentattachmentmap", "domain", "domainsite", "emailservicesaddress", "emailservicesfunction", "emailstatus", "emailtemplate", "entitysubscription", "event", "eventfeed", "eventrelation", "feedcomment", "feeditem", "feedlike", "feedtrackedchange", "fieldpermissions", "fiscalyearsettings", "folder", "forecastshare", "group", "groupmember", "hashtagdefinition", "holiday", "idea", "ideacomment", "loginip", "mailmergetemplate", "mobiledeviceregistrar", "name", "note", "noteandattachment", "objectpermissions", "openactivity", "orgwideemailaddress", "ownedcontentdocument", "period", "permissionset", "permissionsetassignment", "permissionsetlicense", "permissionsetlicenseassign", "processdefinition", "processinstance", "processinstancehistory", "processinstancenode", "processinstancestep", "processinstanceworkitem", "processnode", "profile", "pushtopic", "queuesobject", "recentlyviewed", "recordtype", "report", "reportfeed", "scontrol", "setupentityaccess", "site", "sitefeed", "sitehistory", "staticresource", "task", "taskfeed", "taskpriority", "taskstatus", "topic", "topicassignment", "topicfeed", "undecidedeventrelation", "user", "userfeed", "userlicense", "userpreference", "userprofile", "userrecordaccess", "userrole", "usershare", "vote"]);

'use strict';
angular.module('angular-normalize-salesforce').constant('ansSalesforceSObjects', {
  account: ['masterrecordid', 'currencyisocode', 'division', 'id', 'accountnumber', 'ownerid', 'recordtypeid', 'site', 'accountsource', 'annualrevenue', 'billingstreet', 'billingcity', 'billingstate', 'billingpostalcode', 'billingcountry', 'createdbyid', 'createddate', 'jigsaw', 'isdeleted', 'description', 'numberofemployees', 'isexcludedfromrealign', 'fax', 'industry', 'jigsawcompanyid', 'lastactivitydate', 'lastmodifiedbyid', 'lastmodifieddate', 'lastreferenceddate', 'lastvieweddate', 'ownership', 'parentid', 'phone', 'photourl', 'rating', 'connectionreceivedid', 'sic', 'sicdesc', 'connectionsentid', 'shippingstreet', 'shippingcity', 'shippingstate', 'shippingpostalcode', 'shippingcountry', 'systemmodstamp', 'tickersymbol', 'type', 'website'],
  task: ['accountid', 'currencyisocode', 'id', 'isarchived', 'ownerid', 'calldurationinseconds', 'callobject', 'calldisposition', 'calltype', 'isclosed', 'description', 'isrecurrence', 'createdbyid', 'createddate', 'isdeleted', 'division', 'activitydate', 'recurrenceenddateonly', 'lastmodifiedbyid', 'lastmodifieddate', 'whoid', 'priority', 'isvisibleinselfservice', 'connectionreceivedid', 'recurrenceactivityid', 'recurrencedayofmonth', 'recurrencedayofweekmask', 'recurrenceinstance', 'recurrenceinterval', 'recurrencemonthofyear', 'recurrencetimezonesidkey', 'recurrencetype', 'whatid', 'reminderdatetime', 'isreminderset', 'recurrenceregeneratedtype', 'connectionsentid', 'recurrencestartdateonly', 'status', 'subject', 'systemmodstamp', 'type']
});

'use strict';
var __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

angular.module('angular-normalize-salesforce').factory('normalizeSalesforce', ["ansSalesforceSObjects", "ansSalesforceStandardObjects", "ansSalesforceStandardFields", function(ansSalesforceSObjects, ansSalesforceStandardObjects, ansSalesforceStandardFields) {
  var NormalizeSalesforce;
  return new (NormalizeSalesforce = (function() {
    function NormalizeSalesforce() {
      this._denormalizeObject = __bind(this._denormalizeObject, this);
      this._denormalizeArray = __bind(this._denormalizeArray, this);
      this._denormalizeString = __bind(this._denormalizeString, this);
      this._normalizeObject = __bind(this._normalizeObject, this);
      this._normalizeArray = __bind(this._normalizeArray, this);
      this.denormalizeObjectName = __bind(this.denormalizeObjectName, this);
      this.denormalize = __bind(this.denormalize, this);
      this.normalize = __bind(this.normalize, this);
      this.standardFields = ansSalesforceStandardFields;
      this.standardObjects = ansSalesforceStandardObjects;
      this.sObjectFields = ansSalesforceSObjects;
    }

    NormalizeSalesforce.prototype.normalize = function(part) {
      var type_name;
      type_name = Object.prototype.toString.call(part);
      switch (false) {
        case !_(part).isString():
          return this._normalizeString(part);
        case !_(part).isArray():
          return this._normalizeArray(part);
        case !_(part).isObject():
          return this._normalizeObject(part);
        default:
          throw new Error("Type " + type_name + " not supported. Only String, Array and Object are supported.");
      }
    };

    NormalizeSalesforce.prototype.denormalize = function(part, sObject) {
      var type_name;
      type_name = Object.prototype.toString.call(part);
      switch (false) {
        case !_(part).isString():
          return this._denormalizeString(part, sObject);
        case !_(part).isArray():
          return this._denormalizeArray(part, sObject);
        case !_(part).isObject():
          return this._denormalizeObject(part, sObject);
        default:
          throw new Error("Type " + type_name + " not supported. Only String, Array and Object are supported.");
      }
    };

    NormalizeSalesforce.prototype.denormalizeObjectName = function(name) {
      return this._denormalize(name, this.standardObjects);
    };

    NormalizeSalesforce.prototype._normalizeString = function(string) {
      return string.toLowerCase().replace(/__c$/, '');
    };

    NormalizeSalesforce.prototype._normalizeArray = function(array) {
      return _.map(array, (function(_this) {
        return function(element) {
          return _this.normalize(element);
        };
      })(this));
    };

    NormalizeSalesforce.prototype._normalizeObject = function(object) {
      var normalized;
      normalized = {};
      _(object).forEach((function(_this) {
        return function(value, key) {
          if (_(value).isObject() && !_(value).isFunction()) {
            return normalized[_this.normalize(key)] = _this.normalize(value);
          } else {
            return normalized[_this.normalize(key)] = value;
          }
        };
      })(this));
      return normalized;
    };

    NormalizeSalesforce.prototype._denormalize = function(part, avoidList) {
      if (!_(avoidList).contains(part)) {
        return "" + part + "__c";
      } else {
        return part;
      }
    };

    NormalizeSalesforce.prototype._denormalizeString = function(string, sObject) {
      var standardFields;
      sObject = this.normalize(sObject);
      standardFields = this.standardFields;
      if (_(this.sObjectFields).has(sObject)) {
        standardFields = _.uniq(standardFields.concat(this.sObjectFields[sObject]));
      }
      return this._denormalize(string, standardFields);
    };

    NormalizeSalesforce.prototype._denormalizeArray = function(array, sObject) {
      return _.map(array, (function(_this) {
        return function(element) {
          return _this.denormalize(element, sObject);
        };
      })(this));
    };

    NormalizeSalesforce.prototype._denormalizeObject = function(object, sObject) {
      var denormalized;
      denormalized = {};
      _(object).forEach((function(_this) {
        return function(value, key) {
          if (_(value).isObject() && !_(value).isFunction()) {
            return denormalized[_this.denormalize(key, sObject)] = _this.denormalize(value, sObject);
          } else {
            return denormalized[_this.denormalize(key, sObject)] = value;
          }
        };
      })(this));
      return denormalized;
    };

    return NormalizeSalesforce;

  })());
}]);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFuZ3VsYXItbm9ybWFsaXplLXNhbGVzZm9yY2UuY29mZmVlIiwic2FsZXNmb3JjZS1zdGFuZGFyZC1maWVsZHMuY29mZmVlIiwic2FsZXNmb3JjZS1zdGFuZGFyZC1vYmplY3RzLmNvZmZlZSIsInNhbGVzZm9yY2Utc29iamVjdHMuY29mZmVlIiwic2FsZXNmb3JjZS1zb2JqZWN0cy5qcyIsIm5vcm1hbGl6ZS1zYWxlc2ZvcmNlLmNvZmZlZSIsIm5vcm1hbGl6ZS1zYWxlc2ZvcmNlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7O0FDQUE7QUFBQTs7QUNBQTtBQUFBOztBQ0FBO0FBQUE7RUFJRTtFQWtEQTtBQ2xERjs7QUNKQTtBQUFBOztBQUFBLHdEQUdTLG1CQUFBLEdBQXVCLHlGQUFBO0VBSzlCO0VDSEE7SURJZTtNQUNYO01BQUE7TUFBQTtNQUFBO01BQUE7TUFBQTtNQUFBO01BQUE7TUFBQTtNQUNBO01BQ0E7SUFIVzs7SUFBYjtNQU1FO01BQUE7TUFFQTtRQUFBO1VDUUk7UURSSjtVQ1VJO1FEVko7VUNZSTtRRFpKO1VBS0k7TUFMSjtJQUhTOztJQUxYO01BbUJFO01BQUE7TUFFQTtRQUFBO1VDVUk7UURWSjtVQ1lJO1FEWko7VUNjSTtRRGRKO1VBS0k7TUFMSjtJQUhXOztJQWxCYjtNQzBDRTtJRFhxQjs7SUEvQnZCO01DOENFO0lEVmdCOztJQXBDbEI7TUNrREU7UUFDRTtVQUNFO1FEWlM7TUFBQTtJQURFOztJQXZDakI7TUE0Q0U7TUFBQTtNQUVBO1FDZUU7VURkQTtZQ2dCSTtVQUNGO1lBQ0U7VUFDRjtRRHBCYztNQUFBO01DdUJsQjtJRDFCZ0I7O0lBM0NsQjtNQXVERTtRQ21CRTtNQUNGO1FBQ0U7TUFDRjtJRHZCWTs7SUF0RGQ7TUE2REU7TUFBQTtNQUVBO01BQ0E7UUFDRTtNQ3FCRjtNQUNBO0lEM0JrQjs7SUE1RHBCO01DMkZFO1FBQ0U7VUFDRTtRRHZCUztNQUFBO0lBREk7O0lBckVuQjtNQTBFRTtNQUFBO01BRUE7UUMwQkU7VUR6QkE7WUMyQkk7VUFDRjtZQUNFO1VBQ0Y7UUQvQmM7TUFBQTtNQ2tDbEI7SURyQ2tCOztJQ3dDcEI7O0VBRUY7QUR6SDhCLENBRGhDLENBQUEiLCJmaWxlIjoiYW5ndWxhci1ub3JtYWxpemUtc2FsZXNmb3JjZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0J1xuXG5hbmd1bGFyLm1vZHVsZSgnYW5ndWxhci1ub3JtYWxpemUtc2FsZXNmb3JjZScsW10pXG4iLCIndXNlIHN0cmljdCdcblxuYW5ndWxhci5tb2R1bGUoJ2FuZ3VsYXItbm9ybWFsaXplLXNhbGVzZm9yY2UnKVxuLmNvbnN0YW50ICdhbnNTYWxlc2ZvcmNlU3RhbmRhcmRGaWVsZHMnLCBbXG4gICdpZCdcbiAgJ2lzZGVsZXRlZCdcbiAgJ25hbWUnXG4gICdjcmVhdGVkZGF0ZSdcbiAgJ2NyZWF0ZWRieWlkJ1xuICAnbGFzdG1vZGlmaWVkZGF0ZSdcbiAgJ2xhc3Rtb2RpZmllZGJ5aWQnXG4gICdzeXN0ZW1tb2RzdGFtcCdcbiAgJ2xhc3RhY3Rpdml0eWRhdGUnXG4gICdjdXJyZW5jeWlzb2NvZGUnXG5dXG4iLCIndXNlIHN0cmljdCdcblxuYW5ndWxhci5tb2R1bGUoJ2FuZ3VsYXItbm9ybWFsaXplLXNhbGVzZm9yY2UnKVxuLmNvbnN0YW50ICdhbnNTYWxlc2ZvcmNlU3RhbmRhcmRPYmplY3RzJywgW1xuICBcImFjY2VwdGVkZXZlbnRyZWxhdGlvblwiLFwiYWNjb3VudFwiLFxuICBcImFjY291bnRjb250YWN0cm9sZVwiLFwiYWNjb3VudGZlZWRcIixcImFjY291bnRoaXN0b3J5XCIsXCJhY2NvdW50cGFydG5lclwiLFxuICBcImFjY291bnRzaGFyZVwiLFwiYWN0aXZpdHloaXN0b3J5XCIsXCJhZGRpdGlvbmFsbnVtYmVyXCIsXCJhZ2dyZWdhdGVyZXN1bHRcIixcbiAgXCJhbm5vdW5jZW1lbnRcIixcImFwZXhjbGFzc1wiLFwiYXBleGNvbXBvbmVudFwiLFwiYXBleHBhZ2VcIixcbiAgXCJhcGV4dGVzdHF1ZXVlaXRlbVwiLFwiYXBleHRlc3RyZXN1bHRcIixcImFwZXh0cmlnZ2VyXCIsXCJhcHBtZW51aXRlbVwiLFxuICBcImFzc2lnbm1lbnRydWxlXCIsXCJhc3luY2FwZXhqb2JcIixcImF0dGFjaGVkY29udGVudGRvY3VtZW50XCIsXCJhdHRhY2htZW50XCIsXG4gIFwiYXV0aHNlc3Npb25cIixcImJyYW5kdGVtcGxhdGVcIixcImJ1c2luZXNzaG91cnNcIixcImJ1c2luZXNzcHJvY2Vzc1wiLFxuICBcImNhbGxjZW50ZXJcIixcImNhdGVnb3J5bm9kZVwiLFwiY2hhdHRlcmFjdGl2aXR5XCIsXCJjbGllbnRicm93c2VyXCIsXG4gIFwiY29sbGFib3JhdGlvbmdyb3VwXCIsXCJjb2xsYWJvcmF0aW9uZ3JvdXBmZWVkXCIsXG4gIFwiY29sbGFib3JhdGlvbmdyb3VwbWVtYmVyXCIsXCJjb2xsYWJvcmF0aW9uZ3JvdXBtZW1iZXJyZXF1ZXN0XCIsXG4gIFwiY29sbGFib3JhdGlvbmludml0YXRpb25cIixcImNvbWJpbmVkYXR0YWNobWVudFwiLFwiY29tbXVuaXR5XCIsXCJjb250YWN0XCIsXG4gIFwiY29udGFjdGZlZWRcIixcImNvbnRhY3RoaXN0b3J5XCIsXCJjb250YWN0c2hhcmVcIixcImNvbnRlbnRkb2N1bWVudFwiLFxuICBcImNvbnRlbnRkb2N1bWVudGZlZWRcIixcImNvbnRlbnRkb2N1bWVudGhpc3RvcnlcIixcImNvbnRlbnRkb2N1bWVudGxpbmtcIixcbiAgXCJjb250ZW50dmVyc2lvblwiLFwiY29udGVudHZlcnNpb25oaXN0b3J5XCIsXCJjcm9uam9iZGV0YWlsXCIsXCJjcm9udHJpZ2dlclwiLFxuICBcImRhc2hib2FyZFwiLFwiZGFzaGJvYXJkY29tcG9uZW50XCIsXCJkYXNoYm9hcmRjb21wb25lbnRmZWVkXCIsXG4gIFwiZGFzaGJvYXJkZmVlZFwiLFwiZGVjbGluZWRldmVudHJlbGF0aW9uXCIsXCJkb2N1bWVudFwiLFxuICBcImRvY3VtZW50YXR0YWNobWVudG1hcFwiLFwiZG9tYWluXCIsXCJkb21haW5zaXRlXCIsXCJlbWFpbHNlcnZpY2VzYWRkcmVzc1wiLFxuICBcImVtYWlsc2VydmljZXNmdW5jdGlvblwiLFwiZW1haWxzdGF0dXNcIixcImVtYWlsdGVtcGxhdGVcIixcbiAgXCJlbnRpdHlzdWJzY3JpcHRpb25cIixcImV2ZW50XCIsXCJldmVudGZlZWRcIixcImV2ZW50cmVsYXRpb25cIixcImZlZWRjb21tZW50XCIsXG4gIFwiZmVlZGl0ZW1cIixcImZlZWRsaWtlXCIsXCJmZWVkdHJhY2tlZGNoYW5nZVwiLFwiZmllbGRwZXJtaXNzaW9uc1wiLFxuICBcImZpc2NhbHllYXJzZXR0aW5nc1wiLFwiZm9sZGVyXCIsXCJmb3JlY2FzdHNoYXJlXCIsXCJncm91cFwiLFwiZ3JvdXBtZW1iZXJcIixcbiAgXCJoYXNodGFnZGVmaW5pdGlvblwiLFwiaG9saWRheVwiLFwiaWRlYVwiLFwiaWRlYWNvbW1lbnRcIixcImxvZ2luaXBcIixcbiAgXCJtYWlsbWVyZ2V0ZW1wbGF0ZVwiLFwibW9iaWxlZGV2aWNlcmVnaXN0cmFyXCIsXCJuYW1lXCIsXCJub3RlXCIsXG4gIFwibm90ZWFuZGF0dGFjaG1lbnRcIixcIm9iamVjdHBlcm1pc3Npb25zXCIsXCJvcGVuYWN0aXZpdHlcIixcbiAgXCJvcmd3aWRlZW1haWxhZGRyZXNzXCIsXCJvd25lZGNvbnRlbnRkb2N1bWVudFwiLFwicGVyaW9kXCIsXCJwZXJtaXNzaW9uc2V0XCIsXG4gIFwicGVybWlzc2lvbnNldGFzc2lnbm1lbnRcIixcInBlcm1pc3Npb25zZXRsaWNlbnNlXCIsXG4gIFwicGVybWlzc2lvbnNldGxpY2Vuc2Vhc3NpZ25cIixcInByb2Nlc3NkZWZpbml0aW9uXCIsXCJwcm9jZXNzaW5zdGFuY2VcIixcbiAgXCJwcm9jZXNzaW5zdGFuY2VoaXN0b3J5XCIsXCJwcm9jZXNzaW5zdGFuY2Vub2RlXCIsXCJwcm9jZXNzaW5zdGFuY2VzdGVwXCIsXG4gIFwicHJvY2Vzc2luc3RhbmNld29ya2l0ZW1cIixcInByb2Nlc3Nub2RlXCIsXCJwcm9maWxlXCIsXCJwdXNodG9waWNcIixcbiAgXCJxdWV1ZXNvYmplY3RcIixcInJlY2VudGx5dmlld2VkXCIsXCJyZWNvcmR0eXBlXCIsXCJyZXBvcnRcIixcInJlcG9ydGZlZWRcIixcbiAgXCJzY29udHJvbFwiLFwic2V0dXBlbnRpdHlhY2Nlc3NcIixcInNpdGVcIixcInNpdGVmZWVkXCIsXCJzaXRlaGlzdG9yeVwiLFxuICBcInN0YXRpY3Jlc291cmNlXCIsXCJ0YXNrXCIsXCJ0YXNrZmVlZFwiLFwidGFza3ByaW9yaXR5XCIsXCJ0YXNrc3RhdHVzXCIsXCJ0b3BpY1wiLFxuICBcInRvcGljYXNzaWdubWVudFwiLFwidG9waWNmZWVkXCIsXCJ1bmRlY2lkZWRldmVudHJlbGF0aW9uXCIsXCJ1c2VyXCIsXG4gIFwidXNlcmZlZWRcIixcInVzZXJsaWNlbnNlXCIsXCJ1c2VycHJlZmVyZW5jZVwiLFwidXNlcnByb2ZpbGVcIixcbiAgXCJ1c2VycmVjb3JkYWNjZXNzXCIsXCJ1c2Vycm9sZVwiLFwidXNlcnNoYXJlXCIsXCJ2b3RlXCJcbl1cbiIsIid1c2Ugc3RyaWN0J1xuXG5hbmd1bGFyLm1vZHVsZSgnYW5ndWxhci1ub3JtYWxpemUtc2FsZXNmb3JjZScpXG4uY29uc3RhbnQgJ2Fuc1NhbGVzZm9yY2VTT2JqZWN0cycsIHtcbiAgYWNjb3VudDogW1xuICAgICdtYXN0ZXJyZWNvcmRpZCcsXG4gICAgJ2N1cnJlbmN5aXNvY29kZScsXG4gICAgJ2RpdmlzaW9uJyxcbiAgICAnaWQnLFxuICAgICdhY2NvdW50bnVtYmVyJyxcbiAgICAnb3duZXJpZCcsXG4gICAgJ3JlY29yZHR5cGVpZCcsXG4gICAgJ3NpdGUnLFxuICAgICdhY2NvdW50c291cmNlJyxcbiAgICAnYW5udWFscmV2ZW51ZScsXG4gICAgJ2JpbGxpbmdzdHJlZXQnLFxuICAgICdiaWxsaW5nY2l0eScsXG4gICAgJ2JpbGxpbmdzdGF0ZScsXG4gICAgJ2JpbGxpbmdwb3N0YWxjb2RlJyxcbiAgICAnYmlsbGluZ2NvdW50cnknLFxuICAgICdjcmVhdGVkYnlpZCcsXG4gICAgJ2NyZWF0ZWRkYXRlJyxcbiAgICAnamlnc2F3JyxcbiAgICAnaXNkZWxldGVkJyxcbiAgICAnZGVzY3JpcHRpb24nLFxuICAgICdudW1iZXJvZmVtcGxveWVlcycsXG4gICAgJ2lzZXhjbHVkZWRmcm9tcmVhbGlnbicsXG4gICAgJ2ZheCcsXG4gICAgJ2luZHVzdHJ5JyxcbiAgICAnamlnc2F3Y29tcGFueWlkJyxcbiAgICAnbGFzdGFjdGl2aXR5ZGF0ZScsXG4gICAgJ2xhc3Rtb2RpZmllZGJ5aWQnLFxuICAgICdsYXN0bW9kaWZpZWRkYXRlJyxcbiAgICAnbGFzdHJlZmVyZW5jZWRkYXRlJyxcbiAgICAnbGFzdHZpZXdlZGRhdGUnLFxuICAgICdvd25lcnNoaXAnLFxuICAgICdwYXJlbnRpZCcsXG4gICAgJ3Bob25lJyxcbiAgICAncGhvdG91cmwnLFxuICAgICdyYXRpbmcnLFxuICAgICdjb25uZWN0aW9ucmVjZWl2ZWRpZCcsXG4gICAgJ3NpYycsXG4gICAgJ3NpY2Rlc2MnLFxuICAgICdjb25uZWN0aW9uc2VudGlkJyxcbiAgICAnc2hpcHBpbmdzdHJlZXQnLFxuICAgICdzaGlwcGluZ2NpdHknLFxuICAgICdzaGlwcGluZ3N0YXRlJyxcbiAgICAnc2hpcHBpbmdwb3N0YWxjb2RlJyxcbiAgICAnc2hpcHBpbmdjb3VudHJ5JyxcbiAgICAnc3lzdGVtbW9kc3RhbXAnLFxuICAgICd0aWNrZXJzeW1ib2wnLFxuICAgICd0eXBlJyxcbiAgICAnd2Vic2l0ZSdcbiAgXVxuICB0YXNrOiBbXG4gICAgJ2FjY291bnRpZCcsXG4gICAgJ2N1cnJlbmN5aXNvY29kZScsXG4gICAgJ2lkJyxcbiAgICAnaXNhcmNoaXZlZCcsXG4gICAgJ293bmVyaWQnLFxuICAgICdjYWxsZHVyYXRpb25pbnNlY29uZHMnLFxuICAgICdjYWxsb2JqZWN0JyxcbiAgICAnY2FsbGRpc3Bvc2l0aW9uJyxcbiAgICAnY2FsbHR5cGUnLFxuICAgICdpc2Nsb3NlZCcsXG4gICAgJ2Rlc2NyaXB0aW9uJyxcbiAgICAnaXNyZWN1cnJlbmNlJyxcbiAgICAnY3JlYXRlZGJ5aWQnLFxuICAgICdjcmVhdGVkZGF0ZScsXG4gICAgJ2lzZGVsZXRlZCcsXG4gICAgJ2RpdmlzaW9uJyxcbiAgICAnYWN0aXZpdHlkYXRlJyxcbiAgICAncmVjdXJyZW5jZWVuZGRhdGVvbmx5JyxcbiAgICAnbGFzdG1vZGlmaWVkYnlpZCcsXG4gICAgJ2xhc3Rtb2RpZmllZGRhdGUnLFxuICAgICd3aG9pZCcsXG4gICAgJ3ByaW9yaXR5JyxcbiAgICAnaXN2aXNpYmxlaW5zZWxmc2VydmljZScsXG4gICAgJ2Nvbm5lY3Rpb25yZWNlaXZlZGlkJyxcbiAgICAncmVjdXJyZW5jZWFjdGl2aXR5aWQnLFxuICAgICdyZWN1cnJlbmNlZGF5b2Ztb250aCcsXG4gICAgJ3JlY3VycmVuY2VkYXlvZndlZWttYXNrJyxcbiAgICAncmVjdXJyZW5jZWluc3RhbmNlJyxcbiAgICAncmVjdXJyZW5jZWludGVydmFsJyxcbiAgICAncmVjdXJyZW5jZW1vbnRob2Z5ZWFyJyxcbiAgICAncmVjdXJyZW5jZXRpbWV6b25lc2lka2V5JyxcbiAgICAncmVjdXJyZW5jZXR5cGUnLFxuICAgICd3aGF0aWQnLFxuICAgICdyZW1pbmRlcmRhdGV0aW1lJyxcbiAgICAnaXNyZW1pbmRlcnNldCcsXG4gICAgJ3JlY3VycmVuY2VyZWdlbmVyYXRlZHR5cGUnLFxuICAgICdjb25uZWN0aW9uc2VudGlkJyxcbiAgICAncmVjdXJyZW5jZXN0YXJ0ZGF0ZW9ubHknLFxuICAgICdzdGF0dXMnLFxuICAgICdzdWJqZWN0JyxcbiAgICAnc3lzdGVtbW9kc3RhbXAnLFxuICAgICd0eXBlJ1xuICBdXG59XG4iLCIndXNlIHN0cmljdCc7XG5hbmd1bGFyLm1vZHVsZSgnYW5ndWxhci1ub3JtYWxpemUtc2FsZXNmb3JjZScpLmNvbnN0YW50KCdhbnNTYWxlc2ZvcmNlU09iamVjdHMnLCB7XG4gIGFjY291bnQ6IFsnbWFzdGVycmVjb3JkaWQnLCAnY3VycmVuY3lpc29jb2RlJywgJ2RpdmlzaW9uJywgJ2lkJywgJ2FjY291bnRudW1iZXInLCAnb3duZXJpZCcsICdyZWNvcmR0eXBlaWQnLCAnc2l0ZScsICdhY2NvdW50c291cmNlJywgJ2FubnVhbHJldmVudWUnLCAnYmlsbGluZ3N0cmVldCcsICdiaWxsaW5nY2l0eScsICdiaWxsaW5nc3RhdGUnLCAnYmlsbGluZ3Bvc3RhbGNvZGUnLCAnYmlsbGluZ2NvdW50cnknLCAnY3JlYXRlZGJ5aWQnLCAnY3JlYXRlZGRhdGUnLCAnamlnc2F3JywgJ2lzZGVsZXRlZCcsICdkZXNjcmlwdGlvbicsICdudW1iZXJvZmVtcGxveWVlcycsICdpc2V4Y2x1ZGVkZnJvbXJlYWxpZ24nLCAnZmF4JywgJ2luZHVzdHJ5JywgJ2ppZ3Nhd2NvbXBhbnlpZCcsICdsYXN0YWN0aXZpdHlkYXRlJywgJ2xhc3Rtb2RpZmllZGJ5aWQnLCAnbGFzdG1vZGlmaWVkZGF0ZScsICdsYXN0cmVmZXJlbmNlZGRhdGUnLCAnbGFzdHZpZXdlZGRhdGUnLCAnb3duZXJzaGlwJywgJ3BhcmVudGlkJywgJ3Bob25lJywgJ3Bob3RvdXJsJywgJ3JhdGluZycsICdjb25uZWN0aW9ucmVjZWl2ZWRpZCcsICdzaWMnLCAnc2ljZGVzYycsICdjb25uZWN0aW9uc2VudGlkJywgJ3NoaXBwaW5nc3RyZWV0JywgJ3NoaXBwaW5nY2l0eScsICdzaGlwcGluZ3N0YXRlJywgJ3NoaXBwaW5ncG9zdGFsY29kZScsICdzaGlwcGluZ2NvdW50cnknLCAnc3lzdGVtbW9kc3RhbXAnLCAndGlja2Vyc3ltYm9sJywgJ3R5cGUnLCAnd2Vic2l0ZSddLFxuICB0YXNrOiBbJ2FjY291bnRpZCcsICdjdXJyZW5jeWlzb2NvZGUnLCAnaWQnLCAnaXNhcmNoaXZlZCcsICdvd25lcmlkJywgJ2NhbGxkdXJhdGlvbmluc2Vjb25kcycsICdjYWxsb2JqZWN0JywgJ2NhbGxkaXNwb3NpdGlvbicsICdjYWxsdHlwZScsICdpc2Nsb3NlZCcsICdkZXNjcmlwdGlvbicsICdpc3JlY3VycmVuY2UnLCAnY3JlYXRlZGJ5aWQnLCAnY3JlYXRlZGRhdGUnLCAnaXNkZWxldGVkJywgJ2RpdmlzaW9uJywgJ2FjdGl2aXR5ZGF0ZScsICdyZWN1cnJlbmNlZW5kZGF0ZW9ubHknLCAnbGFzdG1vZGlmaWVkYnlpZCcsICdsYXN0bW9kaWZpZWRkYXRlJywgJ3dob2lkJywgJ3ByaW9yaXR5JywgJ2lzdmlzaWJsZWluc2VsZnNlcnZpY2UnLCAnY29ubmVjdGlvbnJlY2VpdmVkaWQnLCAncmVjdXJyZW5jZWFjdGl2aXR5aWQnLCAncmVjdXJyZW5jZWRheW9mbW9udGgnLCAncmVjdXJyZW5jZWRheW9md2Vla21hc2snLCAncmVjdXJyZW5jZWluc3RhbmNlJywgJ3JlY3VycmVuY2VpbnRlcnZhbCcsICdyZWN1cnJlbmNlbW9udGhvZnllYXInLCAncmVjdXJyZW5jZXRpbWV6b25lc2lka2V5JywgJ3JlY3VycmVuY2V0eXBlJywgJ3doYXRpZCcsICdyZW1pbmRlcmRhdGV0aW1lJywgJ2lzcmVtaW5kZXJzZXQnLCAncmVjdXJyZW5jZXJlZ2VuZXJhdGVkdHlwZScsICdjb25uZWN0aW9uc2VudGlkJywgJ3JlY3VycmVuY2VzdGFydGRhdGVvbmx5JywgJ3N0YXR1cycsICdzdWJqZWN0JywgJ3N5c3RlbW1vZHN0YW1wJywgJ3R5cGUnXVxufSk7XG4iLCIndXNlIHN0cmljdCdcblxuYW5ndWxhci5tb2R1bGUoJ2FuZ3VsYXItbm9ybWFsaXplLXNhbGVzZm9yY2UnKVxuLmZhY3RvcnkgJ25vcm1hbGl6ZVNhbGVzZm9yY2UnLCAoXG4gIGFuc1NhbGVzZm9yY2VTT2JqZWN0cyxcbiAgYW5zU2FsZXNmb3JjZVN0YW5kYXJkT2JqZWN0cyxcbiAgYW5zU2FsZXNmb3JjZVN0YW5kYXJkRmllbGRzXG4pIC0+XG4gIG5ldyBjbGFzcyBOb3JtYWxpemVTYWxlc2ZvcmNlXG4gICAgY29uc3RydWN0b3I6IC0+XG4gICAgICBAc3RhbmRhcmRGaWVsZHMgPSBhbnNTYWxlc2ZvcmNlU3RhbmRhcmRGaWVsZHNcbiAgICAgIEBzdGFuZGFyZE9iamVjdHMgPSBhbnNTYWxlc2ZvcmNlU3RhbmRhcmRPYmplY3RzXG4gICAgICBAc09iamVjdEZpZWxkcyA9IGFuc1NhbGVzZm9yY2VTT2JqZWN0c1xuXG4gICAgbm9ybWFsaXplOiAocGFydCkgPT5cbiAgICAgIHR5cGVfbmFtZSA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChwYXJ0KVxuXG4gICAgICBzd2l0Y2hcbiAgICAgICAgd2hlbiBfKHBhcnQpLmlzU3RyaW5nKCkgdGhlbiBAX25vcm1hbGl6ZVN0cmluZyhwYXJ0KVxuICAgICAgICB3aGVuIF8ocGFydCkuaXNBcnJheSgpICB0aGVuIEBfbm9ybWFsaXplQXJyYXkocGFydClcbiAgICAgICAgd2hlbiBfKHBhcnQpLmlzT2JqZWN0KCkgdGhlbiBAX25vcm1hbGl6ZU9iamVjdChwYXJ0KVxuICAgICAgICBlbHNlXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICAgICAgXCJUeXBlICN7dHlwZV9uYW1lfSBub3Qgc3VwcG9ydGVkLlxuICAgICAgICAgICAgT25seSBTdHJpbmcsIEFycmF5IGFuZCBPYmplY3QgYXJlIHN1cHBvcnRlZC5cIlxuICAgICAgICAgIClcblxuICAgIGRlbm9ybWFsaXplOiAocGFydCwgc09iamVjdCkgPT5cbiAgICAgIHR5cGVfbmFtZSA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChwYXJ0KVxuXG4gICAgICBzd2l0Y2hcbiAgICAgICAgd2hlbiBfKHBhcnQpLmlzU3RyaW5nKCkgdGhlbiBAX2Rlbm9ybWFsaXplU3RyaW5nKHBhcnQsIHNPYmplY3QpXG4gICAgICAgIHdoZW4gXyhwYXJ0KS5pc0FycmF5KCkgIHRoZW4gQF9kZW5vcm1hbGl6ZUFycmF5KHBhcnQsIHNPYmplY3QpXG4gICAgICAgIHdoZW4gXyhwYXJ0KS5pc09iamVjdCgpIHRoZW4gQF9kZW5vcm1hbGl6ZU9iamVjdChwYXJ0LCBzT2JqZWN0KVxuICAgICAgICBlbHNlXG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICAgICAgXCJUeXBlICN7dHlwZV9uYW1lfSBub3Qgc3VwcG9ydGVkLlxuICAgICAgICAgICAgT25seSBTdHJpbmcsIEFycmF5IGFuZCBPYmplY3QgYXJlIHN1cHBvcnRlZC5cIlxuICAgICAgICAgIClcblxuICAgIGRlbm9ybWFsaXplT2JqZWN0TmFtZTogKG5hbWUpID0+XG4gICAgICBAX2Rlbm9ybWFsaXplIG5hbWUsIEBzdGFuZGFyZE9iamVjdHNcblxuICAgICMgUFJJVkFURSAtLS0tLS0tLS0tXG5cbiAgICBfbm9ybWFsaXplU3RyaW5nOiAoc3RyaW5nKSAtPlxuICAgICAgc3RyaW5nLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvX19jJC8sICcnKVxuXG4gICAgX25vcm1hbGl6ZUFycmF5OiAoYXJyYXkpID0+XG4gICAgICBfLm1hcCBhcnJheSwgKGVsZW1lbnQpID0+XG4gICAgICAgIEBub3JtYWxpemUoZWxlbWVudClcblxuICAgIF9ub3JtYWxpemVPYmplY3Q6IChvYmplY3QpID0+XG4gICAgICBub3JtYWxpemVkID0ge31cblxuICAgICAgXyhvYmplY3QpLmZvckVhY2ggKHZhbHVlLCBrZXkpID0+XG4gICAgICAgIGlmIF8odmFsdWUpLmlzT2JqZWN0KCkgJiYgIV8odmFsdWUpLmlzRnVuY3Rpb24oKVxuICAgICAgICAgIG5vcm1hbGl6ZWRbQG5vcm1hbGl6ZShrZXkpXSA9IEBub3JtYWxpemUodmFsdWUpXG4gICAgICAgIGVsc2VcbiAgICAgICAgICBub3JtYWxpemVkW0Bub3JtYWxpemUoa2V5KV0gPSB2YWx1ZVxuXG4gICAgICBub3JtYWxpemVkXG5cbiAgICBfZGVub3JtYWxpemU6IChwYXJ0LCBhdm9pZExpc3QpIC0+XG4gICAgICB1bmxlc3MgXyhhdm9pZExpc3QpLmNvbnRhaW5zKHBhcnQpXG4gICAgICAgIFwiI3twYXJ0fV9fY1wiXG4gICAgICBlbHNlXG4gICAgICAgIHBhcnRcblxuICAgIF9kZW5vcm1hbGl6ZVN0cmluZzogKHN0cmluZywgc09iamVjdCkgPT5cbiAgICAgIHNPYmplY3QgPSBAbm9ybWFsaXplKHNPYmplY3QpXG5cbiAgICAgIHN0YW5kYXJkRmllbGRzID0gQHN0YW5kYXJkRmllbGRzXG4gICAgICBpZiBfKEBzT2JqZWN0RmllbGRzKS5oYXMoc09iamVjdClcbiAgICAgICAgc3RhbmRhcmRGaWVsZHMgPSBfLnVuaXEoc3RhbmRhcmRGaWVsZHMuY29uY2F0KEBzT2JqZWN0RmllbGRzW3NPYmplY3RdKSlcblxuICAgICAgQF9kZW5vcm1hbGl6ZSBzdHJpbmcsIHN0YW5kYXJkRmllbGRzXG5cbiAgICBfZGVub3JtYWxpemVBcnJheTogKGFycmF5LCBzT2JqZWN0KSA9PlxuICAgICAgXy5tYXAgYXJyYXksIChlbGVtZW50KSA9PlxuICAgICAgICBAZGVub3JtYWxpemUoZWxlbWVudCwgc09iamVjdClcblxuICAgIF9kZW5vcm1hbGl6ZU9iamVjdDogKG9iamVjdCwgc09iamVjdCkgPT5cbiAgICAgIGRlbm9ybWFsaXplZCA9IHt9XG5cbiAgICAgIF8ob2JqZWN0KS5mb3JFYWNoICh2YWx1ZSwga2V5KSA9PlxuICAgICAgICBpZiBfKHZhbHVlKS5pc09iamVjdCgpICYmICFfKHZhbHVlKS5pc0Z1bmN0aW9uKClcbiAgICAgICAgICBkZW5vcm1hbGl6ZWRbQGRlbm9ybWFsaXplKGtleSwgc09iamVjdCldID0gQGRlbm9ybWFsaXplKFxuICAgICAgICAgICAgdmFsdWUsIHNPYmplY3RcbiAgICAgICAgICApXG4gICAgICAgIGVsc2VcbiAgICAgICAgICBkZW5vcm1hbGl6ZWRbQGRlbm9ybWFsaXplKGtleSwgc09iamVjdCldID0gdmFsdWVcblxuICAgICAgZGVub3JtYWxpemVkXG4iLCIndXNlIHN0cmljdCc7XG52YXIgX19iaW5kID0gZnVuY3Rpb24oZm4sIG1lKXsgcmV0dXJuIGZ1bmN0aW9uKCl7IHJldHVybiBmbi5hcHBseShtZSwgYXJndW1lbnRzKTsgfTsgfTtcblxuYW5ndWxhci5tb2R1bGUoJ2FuZ3VsYXItbm9ybWFsaXplLXNhbGVzZm9yY2UnKS5mYWN0b3J5KCdub3JtYWxpemVTYWxlc2ZvcmNlJywgZnVuY3Rpb24oYW5zU2FsZXNmb3JjZVNPYmplY3RzLCBhbnNTYWxlc2ZvcmNlU3RhbmRhcmRPYmplY3RzLCBhbnNTYWxlc2ZvcmNlU3RhbmRhcmRGaWVsZHMpIHtcbiAgdmFyIE5vcm1hbGl6ZVNhbGVzZm9yY2U7XG4gIHJldHVybiBuZXcgKE5vcm1hbGl6ZVNhbGVzZm9yY2UgPSAoZnVuY3Rpb24oKSB7XG4gICAgZnVuY3Rpb24gTm9ybWFsaXplU2FsZXNmb3JjZSgpIHtcbiAgICAgIHRoaXMuX2Rlbm9ybWFsaXplT2JqZWN0ID0gX19iaW5kKHRoaXMuX2Rlbm9ybWFsaXplT2JqZWN0LCB0aGlzKTtcbiAgICAgIHRoaXMuX2Rlbm9ybWFsaXplQXJyYXkgPSBfX2JpbmQodGhpcy5fZGVub3JtYWxpemVBcnJheSwgdGhpcyk7XG4gICAgICB0aGlzLl9kZW5vcm1hbGl6ZVN0cmluZyA9IF9fYmluZCh0aGlzLl9kZW5vcm1hbGl6ZVN0cmluZywgdGhpcyk7XG4gICAgICB0aGlzLl9ub3JtYWxpemVPYmplY3QgPSBfX2JpbmQodGhpcy5fbm9ybWFsaXplT2JqZWN0LCB0aGlzKTtcbiAgICAgIHRoaXMuX25vcm1hbGl6ZUFycmF5ID0gX19iaW5kKHRoaXMuX25vcm1hbGl6ZUFycmF5LCB0aGlzKTtcbiAgICAgIHRoaXMuZGVub3JtYWxpemVPYmplY3ROYW1lID0gX19iaW5kKHRoaXMuZGVub3JtYWxpemVPYmplY3ROYW1lLCB0aGlzKTtcbiAgICAgIHRoaXMuZGVub3JtYWxpemUgPSBfX2JpbmQodGhpcy5kZW5vcm1hbGl6ZSwgdGhpcyk7XG4gICAgICB0aGlzLm5vcm1hbGl6ZSA9IF9fYmluZCh0aGlzLm5vcm1hbGl6ZSwgdGhpcyk7XG4gICAgICB0aGlzLnN0YW5kYXJkRmllbGRzID0gYW5zU2FsZXNmb3JjZVN0YW5kYXJkRmllbGRzO1xuICAgICAgdGhpcy5zdGFuZGFyZE9iamVjdHMgPSBhbnNTYWxlc2ZvcmNlU3RhbmRhcmRPYmplY3RzO1xuICAgICAgdGhpcy5zT2JqZWN0RmllbGRzID0gYW5zU2FsZXNmb3JjZVNPYmplY3RzO1xuICAgIH1cblxuICAgIE5vcm1hbGl6ZVNhbGVzZm9yY2UucHJvdG90eXBlLm5vcm1hbGl6ZSA9IGZ1bmN0aW9uKHBhcnQpIHtcbiAgICAgIHZhciB0eXBlX25hbWU7XG4gICAgICB0eXBlX25hbWUgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwocGFydCk7XG4gICAgICBzd2l0Y2ggKGZhbHNlKSB7XG4gICAgICAgIGNhc2UgIV8ocGFydCkuaXNTdHJpbmcoKTpcbiAgICAgICAgICByZXR1cm4gdGhpcy5fbm9ybWFsaXplU3RyaW5nKHBhcnQpO1xuICAgICAgICBjYXNlICFfKHBhcnQpLmlzQXJyYXkoKTpcbiAgICAgICAgICByZXR1cm4gdGhpcy5fbm9ybWFsaXplQXJyYXkocGFydCk7XG4gICAgICAgIGNhc2UgIV8ocGFydCkuaXNPYmplY3QoKTpcbiAgICAgICAgICByZXR1cm4gdGhpcy5fbm9ybWFsaXplT2JqZWN0KHBhcnQpO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlR5cGUgXCIgKyB0eXBlX25hbWUgKyBcIiBub3Qgc3VwcG9ydGVkLiBPbmx5IFN0cmluZywgQXJyYXkgYW5kIE9iamVjdCBhcmUgc3VwcG9ydGVkLlwiKTtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgTm9ybWFsaXplU2FsZXNmb3JjZS5wcm90b3R5cGUuZGVub3JtYWxpemUgPSBmdW5jdGlvbihwYXJ0LCBzT2JqZWN0KSB7XG4gICAgICB2YXIgdHlwZV9uYW1lO1xuICAgICAgdHlwZV9uYW1lID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHBhcnQpO1xuICAgICAgc3dpdGNoIChmYWxzZSkge1xuICAgICAgICBjYXNlICFfKHBhcnQpLmlzU3RyaW5nKCk6XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX2Rlbm9ybWFsaXplU3RyaW5nKHBhcnQsIHNPYmplY3QpO1xuICAgICAgICBjYXNlICFfKHBhcnQpLmlzQXJyYXkoKTpcbiAgICAgICAgICByZXR1cm4gdGhpcy5fZGVub3JtYWxpemVBcnJheShwYXJ0LCBzT2JqZWN0KTtcbiAgICAgICAgY2FzZSAhXyhwYXJ0KS5pc09iamVjdCgpOlxuICAgICAgICAgIHJldHVybiB0aGlzLl9kZW5vcm1hbGl6ZU9iamVjdChwYXJ0LCBzT2JqZWN0KTtcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUeXBlIFwiICsgdHlwZV9uYW1lICsgXCIgbm90IHN1cHBvcnRlZC4gT25seSBTdHJpbmcsIEFycmF5IGFuZCBPYmplY3QgYXJlIHN1cHBvcnRlZC5cIik7XG4gICAgICB9XG4gICAgfTtcblxuICAgIE5vcm1hbGl6ZVNhbGVzZm9yY2UucHJvdG90eXBlLmRlbm9ybWFsaXplT2JqZWN0TmFtZSA9IGZ1bmN0aW9uKG5hbWUpIHtcbiAgICAgIHJldHVybiB0aGlzLl9kZW5vcm1hbGl6ZShuYW1lLCB0aGlzLnN0YW5kYXJkT2JqZWN0cyk7XG4gICAgfTtcblxuICAgIE5vcm1hbGl6ZVNhbGVzZm9yY2UucHJvdG90eXBlLl9ub3JtYWxpemVTdHJpbmcgPSBmdW5jdGlvbihzdHJpbmcpIHtcbiAgICAgIHJldHVybiBzdHJpbmcudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9fX2MkLywgJycpO1xuICAgIH07XG5cbiAgICBOb3JtYWxpemVTYWxlc2ZvcmNlLnByb3RvdHlwZS5fbm9ybWFsaXplQXJyYXkgPSBmdW5jdGlvbihhcnJheSkge1xuICAgICAgcmV0dXJuIF8ubWFwKGFycmF5LCAoZnVuY3Rpb24oX3RoaXMpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGVsZW1lbnQpIHtcbiAgICAgICAgICByZXR1cm4gX3RoaXMubm9ybWFsaXplKGVsZW1lbnQpO1xuICAgICAgICB9O1xuICAgICAgfSkodGhpcykpO1xuICAgIH07XG5cbiAgICBOb3JtYWxpemVTYWxlc2ZvcmNlLnByb3RvdHlwZS5fbm9ybWFsaXplT2JqZWN0ID0gZnVuY3Rpb24ob2JqZWN0KSB7XG4gICAgICB2YXIgbm9ybWFsaXplZDtcbiAgICAgIG5vcm1hbGl6ZWQgPSB7fTtcbiAgICAgIF8ob2JqZWN0KS5mb3JFYWNoKChmdW5jdGlvbihfdGhpcykge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24odmFsdWUsIGtleSkge1xuICAgICAgICAgIGlmIChfKHZhbHVlKS5pc09iamVjdCgpICYmICFfKHZhbHVlKS5pc0Z1bmN0aW9uKCkpIHtcbiAgICAgICAgICAgIHJldHVybiBub3JtYWxpemVkW190aGlzLm5vcm1hbGl6ZShrZXkpXSA9IF90aGlzLm5vcm1hbGl6ZSh2YWx1ZSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBub3JtYWxpemVkW190aGlzLm5vcm1hbGl6ZShrZXkpXSA9IHZhbHVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgIH0pKHRoaXMpKTtcbiAgICAgIHJldHVybiBub3JtYWxpemVkO1xuICAgIH07XG5cbiAgICBOb3JtYWxpemVTYWxlc2ZvcmNlLnByb3RvdHlwZS5fZGVub3JtYWxpemUgPSBmdW5jdGlvbihwYXJ0LCBhdm9pZExpc3QpIHtcbiAgICAgIGlmICghXyhhdm9pZExpc3QpLmNvbnRhaW5zKHBhcnQpKSB7XG4gICAgICAgIHJldHVybiBcIlwiICsgcGFydCArIFwiX19jXCI7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gcGFydDtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgTm9ybWFsaXplU2FsZXNmb3JjZS5wcm90b3R5cGUuX2Rlbm9ybWFsaXplU3RyaW5nID0gZnVuY3Rpb24oc3RyaW5nLCBzT2JqZWN0KSB7XG4gICAgICB2YXIgc3RhbmRhcmRGaWVsZHM7XG4gICAgICBzT2JqZWN0ID0gdGhpcy5ub3JtYWxpemUoc09iamVjdCk7XG4gICAgICBzdGFuZGFyZEZpZWxkcyA9IHRoaXMuc3RhbmRhcmRGaWVsZHM7XG4gICAgICBpZiAoXyh0aGlzLnNPYmplY3RGaWVsZHMpLmhhcyhzT2JqZWN0KSkge1xuICAgICAgICBzdGFuZGFyZEZpZWxkcyA9IF8udW5pcShzdGFuZGFyZEZpZWxkcy5jb25jYXQodGhpcy5zT2JqZWN0RmllbGRzW3NPYmplY3RdKSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcy5fZGVub3JtYWxpemUoc3RyaW5nLCBzdGFuZGFyZEZpZWxkcyk7XG4gICAgfTtcblxuICAgIE5vcm1hbGl6ZVNhbGVzZm9yY2UucHJvdG90eXBlLl9kZW5vcm1hbGl6ZUFycmF5ID0gZnVuY3Rpb24oYXJyYXksIHNPYmplY3QpIHtcbiAgICAgIHJldHVybiBfLm1hcChhcnJheSwgKGZ1bmN0aW9uKF90aGlzKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbihlbGVtZW50KSB7XG4gICAgICAgICAgcmV0dXJuIF90aGlzLmRlbm9ybWFsaXplKGVsZW1lbnQsIHNPYmplY3QpO1xuICAgICAgICB9O1xuICAgICAgfSkodGhpcykpO1xuICAgIH07XG5cbiAgICBOb3JtYWxpemVTYWxlc2ZvcmNlLnByb3RvdHlwZS5fZGVub3JtYWxpemVPYmplY3QgPSBmdW5jdGlvbihvYmplY3QsIHNPYmplY3QpIHtcbiAgICAgIHZhciBkZW5vcm1hbGl6ZWQ7XG4gICAgICBkZW5vcm1hbGl6ZWQgPSB7fTtcbiAgICAgIF8ob2JqZWN0KS5mb3JFYWNoKChmdW5jdGlvbihfdGhpcykge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24odmFsdWUsIGtleSkge1xuICAgICAgICAgIGlmIChfKHZhbHVlKS5pc09iamVjdCgpICYmICFfKHZhbHVlKS5pc0Z1bmN0aW9uKCkpIHtcbiAgICAgICAgICAgIHJldHVybiBkZW5vcm1hbGl6ZWRbX3RoaXMuZGVub3JtYWxpemUoa2V5LCBzT2JqZWN0KV0gPSBfdGhpcy5kZW5vcm1hbGl6ZSh2YWx1ZSwgc09iamVjdCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBkZW5vcm1hbGl6ZWRbX3RoaXMuZGVub3JtYWxpemUoa2V5LCBzT2JqZWN0KV0gPSB2YWx1ZTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9KSh0aGlzKSk7XG4gICAgICByZXR1cm4gZGVub3JtYWxpemVkO1xuICAgIH07XG5cbiAgICByZXR1cm4gTm9ybWFsaXplU2FsZXNmb3JjZTtcblxuICB9KSgpKTtcbn0pO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9